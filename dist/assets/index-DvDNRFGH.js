import{af as Z,r as h,j as e,Q as a,a7 as j,p as P,S as l,ag as c,T as t,h as $,e as S,X as J}from"./index-CaG8M5h2.js";import{u as K,I as f}from"./hazard-observations-C1b8ZGy9.js";import{P as E}from"./page-7q-nXRSK.js";import{P as N}from"./page-header-D4DTMrtM.js";import{u as V}from"./attendance-Coz97Y7C.js";import{u as Y}from"./employees-CWQnlWGK.js";import{W as H}from"./index-CfEI46TR.js";import{c as B}from"./createReactComponent-uvbWfLFZ.js";import{T as y}from"./Title-sNodV35I.js";import{G as u,D as L}from"./DatePickerInput-BVGwnJ26.js";import{I}from"./IconX-DDzQRBI8.js";import"./date-DHQ8p-RG.js";import"./Anchor-ubl2BGQ_.js";/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var v=B("outline","calendar","IconCalendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ee=B("outline","user","IconUser",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]]);function pe(){var k,D;const{id:m}=Z(),[d,w]=h.useState([null,null]),[n,_]=h.useState([null,null]),[R,M]=h.useState(1),[O,T]=h.useState(1),z=10,{data:g,isLoading:A}=Y(),r=h.useMemo(()=>g==null?void 0:g.find(s=>s.id===m),[g,m]),{data:i,isLoading:b}=V({query:{user_id:m,start_date:d[0]?d[0].toString():void 0,end_date:d[1]?d[1].toString():void 0}}),{data:x,isLoading:C}=K(),p=h.useMemo(()=>{if(!(x!=null&&x.data))return[];let s=x.data.filter(o=>o.observer_id===m);return n[0]&&(s=s.filter(o=>new Date(o.observation_date)>=n[0])),n[1]&&(s=s.filter(o=>new Date(o.observation_date)<=n[1])),s},[x,m,n]);if(A||!r)return e.jsx(E,{title:"Employee Details",children:e.jsx(a,{justify:"center",py:"xl",children:e.jsx(j,{size:"lg"})})});const G=[{label:"Employees",href:P.manager.employees},{label:r.name||"Employee Details",href:P.manager.employeeDetail(m)}],U=((k=i==null?void 0:i.data)==null?void 0:k.length)||0,F=p.length,W=p.filter(s=>s.status==="open").length,X=p.filter(s=>s.status==="resolved").length,q=[{accessor:"check_in_time",title:"Date",render:s=>new Date(s.check_in_time).toLocaleDateString()},{accessor:"check_in_time",title:"Check In",render:s=>new Date(s.check_in_time).toLocaleTimeString()},{accessor:"check_out_time",title:"Check Out",render:s=>s.check_out_time?new Date(s.check_out_time).toLocaleTimeString():"-"},{accessor:"location_id",title:"Location",render:s=>s.location_name||s.location_id}],Q=[{accessor:"observation_date",title:"Date",render:s=>new Date(s.observation_date).toLocaleDateString()},{accessor:"facility_name",title:"Facility",render:s=>s.facility_name||s.facility_id},{accessor:"unsafe_action_condition",title:"Description",ellipsis:!0},{accessor:"status",title:"Status",render:s=>{var o;return e.jsx(J,{color:s.status==="open"?"red":s.status==="in_progress"?"yellow":s.status==="resolved"?"green":"gray",children:(o=s.status)==null?void 0:o.replace("_"," ").toUpperCase()})}}];return e.jsxs(E,{title:`Employee: ${r.name}`,children:[e.jsx(N,{title:r.name||"Employee Details",breadcrumbs:G}),e.jsxs(l,{gap:"lg",children:[e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(l,{gap:"md",children:[e.jsxs(a,{children:[e.jsx(ee,{size:24}),e.jsx(y,{order:3,children:"Employee Information"})]}),e.jsxs(u,{children:[e.jsxs(u.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Email"}),e.jsx(t,{fw:500,children:r.email||"-"})]}),e.jsxs(u.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Department"}),e.jsx(t,{fw:500,children:r.department||"-"})]}),e.jsxs(u.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Position"}),e.jsx(t,{fw:500,children:r.position||"-"})]}),e.jsxs(u.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Hire Date"}),e.jsx(t,{fw:500,children:r.hire_date?new Date(r.hire_date).toLocaleDateString():"-"})]})]})]})}),e.jsxs($,{cols:{base:1,sm:2,md:4},children:[e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(a,{justify:"space-between",children:[e.jsxs(l,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Total Attendance Days"}),e.jsx(t,{size:"xl",fw:700,children:U})]}),e.jsx(v,{size:32,stroke:1.5,color:"var(--mantine-color-blue-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(a,{justify:"space-between",children:[e.jsxs(l,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Total HOCs"}),e.jsx(t,{size:"xl",fw:700,children:F})]}),e.jsx(f,{size:32,stroke:1.5,color:"var(--mantine-color-violet-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(a,{justify:"space-between",children:[e.jsxs(l,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Open HOCs"}),e.jsx(t,{size:"xl",fw:700,children:W})]}),e.jsx(f,{size:32,stroke:1.5,color:"var(--mantine-color-red-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(a,{justify:"space-between",children:[e.jsxs(l,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Resolved HOCs"}),e.jsx(t,{size:"xl",fw:700,children:X})]}),e.jsx(f,{size:32,stroke:1.5,color:"var(--mantine-color-green-6)"})]})})]}),e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(l,{gap:"md",children:[e.jsxs(a,{justify:"space-between",children:[e.jsx(y,{order:4,children:"Attendance Records"}),e.jsxs(a,{gap:"sm",children:[e.jsx(L,{type:"range",placeholder:"Pick date range",value:d,onChange:w,clearable:!0,size:"xs",leftSection:e.jsx(v,{size:16})}),(d[0]||d[1])&&e.jsx(S,{size:"xs",variant:"subtle",color:"gray",onClick:()=>w([null,null]),leftSection:e.jsx(I,{size:14}),children:"Clear"})]})]}),b?e.jsx(a,{justify:"center",py:"xl",children:e.jsx(j,{})}):e.jsx(H,{withTableBorder:!1,mih:200,columns:q,records:(i==null?void 0:i.data)||[],totalRecords:((D=i==null?void 0:i.meta)==null?void 0:D.total)||0,fetching:b,page:R,onPageChange:M,recordsPerPage:z})]})}),e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(l,{gap:"md",children:[e.jsxs(a,{justify:"space-between",children:[e.jsx(y,{order:4,children:"Hazard Observation Cards"}),e.jsxs(a,{gap:"sm",children:[e.jsx(L,{type:"range",placeholder:"Pick date range",value:n,onChange:_,clearable:!0,size:"xs",leftSection:e.jsx(v,{size:16})}),(n[0]||n[1])&&e.jsx(S,{size:"xs",variant:"subtle",color:"gray",onClick:()=>_([null,null]),leftSection:e.jsx(I,{size:14}),children:"Clear"})]})]}),C?e.jsx(a,{justify:"center",py:"xl",children:e.jsx(j,{})}):e.jsx(H,{withTableBorder:!1,mih:200,columns:Q,records:p,totalRecords:p.length,fetching:C,page:O,onPageChange:T,recordsPerPage:z})]})})]})]})}export{pe as default};
