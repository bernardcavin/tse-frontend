import{r as l,ay as ge}from"./index-CXSFYyxW.js";function Pe(t,e){return r=>{const s=t.safeParse(r);if(s.success)return{};const n={};return"error"in s&&s.error.errors.forEach(o=>{n[o.path.join(".")]=o.message}),n}}function Se(t){if(!/^[0-9a-zA-Z-]+$/.test(t))throw new Error(`[@mantine/use-form] Form name "${t}" is invalid, it should contain only letters, numbers and dashes`)}const pe=typeof window<"u"?l.useLayoutEffect:l.useEffect;function C(t,e){pe(()=>{if(t)return window.addEventListener(t,e),()=>window.removeEventListener(t,e)},[t])}function Fe(t,e){t&&Se(t),C(`mantine-form:${t}:set-field-value`,r=>e.setFieldValue(r.detail.path,r.detail.value)),C(`mantine-form:${t}:set-values`,r=>e.setValues(r.detail)),C(`mantine-form:${t}:set-initial-values`,r=>e.setInitialValues(r.detail)),C(`mantine-form:${t}:set-errors`,r=>e.setErrors(r.detail)),C(`mantine-form:${t}:set-field-error`,r=>e.setFieldError(r.detail.path,r.detail.error)),C(`mantine-form:${t}:clear-field-error`,r=>e.clearFieldError(r.detail)),C(`mantine-form:${t}:clear-errors`,e.clearErrors),C(`mantine-form:${t}:reset`,e.reset),C(`mantine-form:${t}:validate`,e.validate),C(`mantine-form:${t}:validate-field`,r=>e.validateField(r.detail)),C(`mantine-form:${t}:reorder-list-item`,r=>e.reorderListItem(r.detail.path,r.detail.payload)),C(`mantine-form:${t}:remove-list-item`,r=>e.removeListItem(r.detail.path,r.detail.index)),C(`mantine-form:${t}:insert-list-item`,r=>e.insertListItem(r.detail.path,r.detail.item,r.detail.index)),C(`mantine-form:${t}:set-dirty`,r=>e.setDirty(r.detail)),C(`mantine-form:${t}:set-touched`,r=>e.setTouched(r.detail)),C(`mantine-form:${t}:reset-dirty`,r=>e.resetDirty(r.detail)),C(`mantine-form:${t}:reset-touched`,e.resetTouched)}function me(t){return e=>{if(!e)t(e);else if(typeof e=="function")t(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:r}=e;r instanceof HTMLInputElement?r.type==="checkbox"?t(r.checked):t(r.value):(r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement)&&t(r.value)}else t(e)}}function U(t){return t===null||typeof t!="object"?{}:Object.keys(t).reduce((e,r)=>{const s=t[r];return s!=null&&s!==!1&&(e[r]=s),e},{})}function je(t){const[e,r]=l.useState(U(t)),s=l.useRef(e),n=l.useCallback(c=>{r(a=>{const V=U(typeof c=="function"?c(a):c);return s.current=V,V})},[]),o=l.useCallback(()=>n({}),[]),u=l.useCallback(c=>{s.current[c]!==void 0&&n(a=>{const V={...a};return delete V[c],V})},[e]),f=l.useCallback((c,a)=>{a==null||a===!1?u(c):s.current[c]!==a&&n(V=>({...V,[c]:a}))},[e]);return{errorsState:e,setErrors:n,clearErrors:o,setFieldError:f,clearFieldError:u}}function X(t,e){if(e===null||typeof e!="object")return{};const r={...e};return Object.keys(e).forEach(s=>{s.includes(`${String(t)}.`)&&delete r[s]}),r}function x(t,e){const r=t.substring(e.length+1).split(".")[0];return parseInt(r,10)}function ee(t,e,r,s){if(e===void 0)return r;const n=`${String(t)}`;let o=r;s===-1&&(o=X(`${n}.${e}`,o));const u={...o},f=new Set;return Object.entries(o).filter(([c])=>{if(!c.startsWith(`${n}.`))return!1;const a=x(c,n);return Number.isNaN(a)?!1:a>=e}).forEach(([c,a])=>{const V=x(c,n),m=c.replace(`${n}.${V}`,`${n}.${V+s}`);u[m]=a,f.add(m),f.has(c)||delete u[c]}),u}function ke(t,{from:e,to:r},s){const n=`${t}.${e}`,o=`${t}.${r}`,u={...s},f=new Set;return Object.keys(s).forEach(c=>{if(f.has(c))return;let a,V;if(c.startsWith(n)?(a=c,V=c.replace(n,o)):c.startsWith(o)&&(a=c.replace(o,n),V=c),a&&V){const m=u[a],k=u[V];k===void 0?delete u[a]:u[a]=k,m===void 0?delete u[V]:u[V]=m,f.add(a),f.add(V)}}),u}function te(t,e,r){typeof r.value=="object"&&(r.value=L(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||e==="__proto__"?Object.defineProperty(t,e,r):t[e]=r.value}function L(t){if(typeof t!="object")return t;var e=0,r,s,n,o=Object.prototype.toString.call(t);if(o==="[object Object]"?n=Object.create(t.__proto__||null):o==="[object Array]"?n=Array(t.length):o==="[object Set]"?(n=new Set,t.forEach(function(u){n.add(L(u))})):o==="[object Map]"?(n=new Map,t.forEach(function(u,f){n.set(L(f),L(u))})):o==="[object Date]"?n=new Date(+t):o==="[object RegExp]"?n=new RegExp(t.source,t.flags):o==="[object DataView]"?n=new t.constructor(L(t.buffer)):o==="[object ArrayBuffer]"?n=t.slice(0):o.slice(-6)==="Array]"&&(n=new t.constructor(t)),n){for(s=Object.getOwnPropertySymbols(t);e<s.length;e++)te(n,s[e],Object.getOwnPropertyDescriptor(t,s[e]));for(e=0,s=Object.getOwnPropertyNames(t);e<s.length;e++)Object.hasOwnProperty.call(n,r=s[e])&&n[r]===t[r]||te(n,r,Object.getOwnPropertyDescriptor(t,r))}return n||t}function oe(t){return typeof t!="string"?[]:t.split(".")}function F(t,e){const r=oe(t);if(r.length===0||typeof e!="object"||e===null)return;let s=e[r[0]];for(let n=1;n<r.length&&s!=null;n+=1)s=s[r[n]];return s}function N(t,e,r){const s=oe(t);if(s.length===0)return r;const n=L(r);if(s.length===1)return n[s[0]]=e,n;let o=n[s[0]];for(let u=1;u<s.length-1;u+=1){if(o===void 0)return n;o=o[s[u]]}return o[s[s.length-1]]=e,n}function Ce(t,{from:e,to:r},s){const n=F(t,s);if(!Array.isArray(n))return s;const o=[...n],u=n[e];return o.splice(e,1),o.splice(r,0,u),N(t,o,s)}function Oe(t,e,r,s){const n=F(t,s);if(!Array.isArray(n))return s;const o=[...n];return o.splice(typeof r=="number"?r:o.length,0,e),N(t,o,s)}function De(t,e,r){const s=F(t,r);return Array.isArray(s)?N(t,s.filter((n,o)=>o!==e),r):r}function he(t,e,r,s){const n=F(t,s);if(!Array.isArray(n)||n.length<=r)return s;const o=[...n];return o[r]=e,N(t,o,s)}function we({$values:t,$errors:e,$status:r}){const s=l.useCallback((f,c)=>{r.clearFieldDirty(f),e.setErrors(a=>ke(f,c,a)),t.setValues({values:Ce(f,c,t.refValues.current),updateState:!0})},[]),n=l.useCallback((f,c)=>{r.clearFieldDirty(f),e.setErrors(a=>ee(f,c,a,-1)),t.setValues({values:De(f,c,t.refValues.current),updateState:!0})},[]),o=l.useCallback((f,c,a)=>{r.clearFieldDirty(f),e.setErrors(V=>ee(f,a,V,1)),t.setValues({values:Oe(f,c,a,t.refValues.current),updateState:!0})},[]),u=l.useCallback((f,c,a)=>{r.clearFieldDirty(f),t.setValues({values:he(f,a,c,t.refValues.current),updateState:!0})},[]);return{reorderListItem:s,removeListItem:n,insertListItem:o,replaceListItem:u}}var $e=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var s,n,o;if(Array.isArray(e)){if(s=e.length,s!=r.length)return!1;for(n=s;n--!==0;)if(!t(e[n],r[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),s=o.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=s;n--!==0;){var u=o[n];if(!t(e[u],r[u]))return!1}return!0}return e!==e&&r!==r};const W=ge($e);function z(t,e){const r=Object.keys(t);if(typeof e=="string"){const s=r.filter(n=>n.startsWith(`${e}.`));return t[e]||s.some(n=>t[n])||!1}return r.some(s=>t[s])}function Re({initialDirty:t,initialTouched:e,mode:r,$values:s}){const[n,o]=l.useState(e),[u,f]=l.useState(t),c=l.useRef(e),a=l.useRef(t),V=l.useCallback(d=>{const S=typeof d=="function"?d(c.current):d;c.current=S,r==="controlled"&&o(S)},[]),m=l.useCallback((d,S=!1)=>{const p=typeof d=="function"?d(a.current):d;a.current=p,(r==="controlled"||S)&&f(p)},[]),k=l.useCallback(()=>V({}),[]),I=l.useCallback(d=>{const S=d?{...s.refValues.current,...d}:s.refValues.current;s.setValuesSnapshot(S),m({})},[]),P=l.useCallback((d,S)=>{V(p=>z(p,d)===S?p:{...p,[d]:S})},[]),_=l.useCallback((d,S,p)=>{m(h=>z(h,d)===S?h:{...h,[d]:S},p)},[]),y=l.useCallback((d,S)=>{const p=z(a.current,d),h=!W(F(d,s.getValuesSnapshot()),S),T=X(d,a.current);T[d]=h,m(T,p!==h)},[]),b=l.useCallback(d=>z(c.current,d),[]),g=l.useCallback(d=>m(S=>{if(typeof d!="string")return S;const p=X(d,S);return delete p[d],W(p,S)?S:p}),[]),D=l.useCallback(d=>{if(d){const p=F(d,a.current);if(typeof p=="boolean")return p;const h=F(d,s.refValues.current),T=F(d,s.valuesSnapshot.current);return!W(h,T)}return Object.keys(a.current).length>0?z(a.current):!W(s.refValues.current,s.valuesSnapshot.current)},[]),O=l.useCallback(()=>a.current,[]),R=l.useCallback(()=>c.current,[]);return{touchedState:n,dirtyState:u,touchedRef:c,dirtyRef:a,setTouched:V,setDirty:m,resetDirty:I,resetTouched:k,isTouched:b,setFieldTouched:P,setFieldDirty:_,setTouchedState:o,setDirtyState:f,clearFieldDirty:g,isDirty:D,getDirty:O,getTouched:R,setCalculatedFieldDirty:y}}function Te({initialValues:t,onValuesChange:e,mode:r}){const s=l.useRef(!1),[n,o]=l.useState(t||{}),u=l.useRef(n),f=l.useRef(n),c=l.useCallback(({values:y,subscribers:b,updateState:g=!0,mergeWithPreviousValues:D=!0})=>{const O=u.current,R=y instanceof Function?y(u.current):y,d=D?{...O,...R}:R;u.current=d,g&&(o(d),r==="uncontrolled"&&(u.current=d)),e==null||e(d,O),b==null||b.filter(Boolean).forEach(S=>S({updatedValues:d,previousValues:O}))},[e]),a=l.useCallback(y=>{var D;const b=F(y.path,u.current),g=y.value instanceof Function?y.value(b):y.value;if(b!==g){const O=u.current,R=N(y.path,g,u.current);c({values:R,updateState:y.updateState}),(D=y.subscribers)==null||D.filter(Boolean).forEach(d=>d({path:y.path,updatedValues:R,previousValues:O}))}},[c]),V=l.useCallback(y=>{f.current=y},[]),m=l.useCallback((y,b)=>{s.current||(s.current=!0,c({values:y,updateState:r==="controlled"}),V(y),b())},[c]),k=l.useCallback(()=>{c({values:f.current,updateState:!0,mergeWithPreviousValues:!1})},[c]),I=l.useCallback(()=>u.current,[]),P=l.useCallback(()=>f.current,[]),_=l.useCallback((y,b)=>{const g=F(y,f.current);typeof g>"u"||a({path:y,value:g,updateState:r==="controlled",subscribers:b})},[a,r]);return{initialized:s,stateValues:n,refValues:u,valuesSnapshot:f,setValues:c,setFieldValue:a,resetValues:k,setValuesSnapshot:V,initialize:m,getValues:I,getValuesSnapshot:P,resetField:_}}function Ae({$status:t,cascadeUpdates:e}){const r=l.useRef({}),s=l.useCallback((o,u)=>{l.useEffect(()=>(r.current[o]=r.current[o]||[],r.current[o].push(u),()=>{r.current[o]=r.current[o].filter(f=>f!==u)}),[u])},[]),n=l.useCallback(o=>{var f;const u=((f=r.current[o])==null?void 0:f.map(c=>a=>c({previousValue:F(o,a.previousValues),value:F(o,a.updatedValues),touched:t.isTouched(o),dirty:t.isDirty(o)})))??[];if(e)for(const c in r.current)(c.startsWith(`${o}.`)||o.startsWith(`${c}.`))&&u.push(...r.current[c].map(a=>V=>a({previousValue:F(c,V.previousValues),value:F(c,V.updatedValues),touched:t.isTouched(c),dirty:t.isDirty(c)})));return u},[]);return{subscribers:r,watch:s,getFieldSubscribers:n}}function re(t,e){return t?`${t}-${e.toString()}`:e.toString()}const q=Symbol("root-rule");function se(t){const e=U(t);return{hasErrors:Object.keys(e).length>0,errors:e}}function Z(t,e,r="",s={}){return typeof t!="object"||t===null?s:Object.keys(t).reduce((n,o)=>{const u=t[o],f=`${r===""?"":`${r}.`}${o}`,c=F(f,e);let a=!1;return typeof u=="function"&&(n[f]=u(c,e,f)),typeof u=="object"&&Array.isArray(c)&&(a=!0,c.forEach((V,m)=>Z(u,e,`${f}.${m}`,n)),q in u&&(n[f]=u[q](c,e,f))),typeof u=="object"&&typeof c=="object"&&c!==null&&(a||Z(u,e,f,n),q in u&&(n[f]=u[q](c,e,f))),n},s)}function J(t,e){return se(typeof t=="function"?t(e):Z(t,e))}function B(t,e,r){if(typeof t!="string")return{hasError:!1,error:null};const s=J(e,r),n=Object.keys(s.errors).find(o=>t.split(".").every((u,f)=>u===o.split(".")[f]));return{hasError:!!n,error:n?s.errors[n]:null}}const Ie="__MANTINE_FORM_INDEX__";function ne(t,e){return e?typeof e=="boolean"?e:Array.isArray(e)?e.includes(t.replace(/[.][0-9]+/g,`.${Ie}`)):!1:!1}function _e({name:t,mode:e="controlled",initialValues:r,initialErrors:s={},initialDirty:n={},initialTouched:o={},clearInputErrorOnChange:u=!0,validateInputOnChange:f=!1,validateInputOnBlur:c=!1,onValuesChange:a,transformValues:V=y=>y,enhanceGetInputProps:m,validate:k,onSubmitPreventDefault:I="always",touchTrigger:P="change",cascadeUpdates:_=!1}={}){const y=je(s),b=Te({initialValues:r,onValuesChange:a,mode:e}),g=Re({initialDirty:n,initialTouched:o,$values:b,mode:e}),D=we({$values:b,$errors:y,$status:g}),O=Ae({$status:g,cascadeUpdates:_}),[R,d]=l.useState(0),[S,p]=l.useState({}),[h,T]=l.useState(!1),Q=l.useCallback(()=>{b.resetValues(),y.clearErrors(),g.resetDirty(),g.resetTouched(),e==="uncontrolled"&&d(i=>i+1)},[]),K=l.useCallback(i=>{u&&y.clearErrors(),e==="uncontrolled"&&d(E=>E+1),Object.keys(O.subscribers.current).forEach(E=>{const j=F(E,b.refValues.current),w=F(E,i);j!==w&&O.getFieldSubscribers(E).forEach(A=>A({previousValues:i,updatedValues:b.refValues.current}))})},[u]),ce=l.useCallback(i=>{const E=b.refValues.current;b.initialize(i,()=>e==="uncontrolled"&&d(j=>j+1)),K(E)},[K]),Y=l.useCallback((i,E,j)=>{const w=ne(i,f),A=E instanceof Function?E(F(i,b.refValues.current)):E;g.setCalculatedFieldDirty(i,A),P==="change"&&g.setFieldTouched(i,!0),!w&&u&&y.clearFieldError(i),b.setFieldValue({path:i,value:E,updateState:e==="controlled",subscribers:[...O.getFieldSubscribers(i),w?v=>{const $=B(i,k,v.updatedValues);$.hasError?y.setFieldError(i,$.error):y.clearFieldError(i)}:null,(j==null?void 0:j.forceUpdate)!==!1&&e!=="controlled"?()=>p(v=>({...v,[i]:(v[i]||0)+1})):null]})},[a,k]),ue=l.useCallback(i=>{const E=b.refValues.current;b.setValues({values:i,updateState:e==="controlled"}),K(E)},[a,K]),G=l.useCallback(()=>{const i=J(k,b.refValues.current);return y.setErrors(i.errors),i},[k]),ie=l.useCallback(i=>{const E=B(i,k,b.refValues.current);return E.hasError?y.setFieldError(i,E.error):y.clearFieldError(i),E},[k]),le=(i,{type:E="input",withError:j=!0,withFocus:w=!0,...A}={})=>{const $={onChange:me(M=>Y(i,M,{forceUpdate:!1})),"data-path":re(t,i)};return j&&($.error=y.errorsState[i]),E==="checkbox"?$[e==="controlled"?"checked":"defaultChecked"]=F(i,b.refValues.current):$[e==="controlled"?"value":"defaultValue"]=F(i,b.refValues.current),w&&($.onFocus=()=>g.setFieldTouched(i,!0),$.onBlur=()=>{if(ne(i,c)){const M=B(i,k,b.refValues.current);M.hasError?y.setFieldError(i,M.error):y.clearFieldError(i)}}),Object.assign($,m==null?void 0:m({inputProps:$,field:i,options:{type:E,withError:j,withFocus:w,...A},form:H}))},ae=(i,E)=>j=>{I==="always"&&(j==null||j.preventDefault());const w=G();if(w.hasErrors)I==="validation-failed"&&(j==null||j.preventDefault()),E==null||E(w.errors,b.refValues.current,j);else{const A=i==null?void 0:i(V(b.refValues.current),j);A instanceof Promise&&(T(!0),A.finally(()=>T(!1)))}},fe=i=>V(i||b.refValues.current),de=l.useCallback(i=>{i.preventDefault(),Q()},[]),ye=l.useCallback(i=>i?!B(i,k,b.refValues.current).hasError:!J(k,b.refValues.current).hasErrors,[k]),be=i=>`${R}-${String(i)}-${S[String(i)]||0}`,Ve=l.useCallback(i=>document.querySelector(`[data-path="${re(t,i)}"]`),[]),Ee=l.useCallback(i=>{b.resetField(i,[e!=="controlled"?()=>p(E=>({...E,[i]:(E[i]||0)+1})):null])},[b.resetField,e,p]),H={watch:O.watch,initialized:b.initialized.current,values:e==="uncontrolled"?b.refValues.current:b.stateValues,getValues:b.getValues,getInitialValues:b.getValuesSnapshot,setInitialValues:b.setValuesSnapshot,resetField:Ee,initialize:ce,setValues:ue,setFieldValue:Y,submitting:h,setSubmitting:T,errors:y.errorsState,setErrors:y.setErrors,setFieldError:y.setFieldError,clearFieldError:y.clearFieldError,clearErrors:y.clearErrors,resetDirty:g.resetDirty,setTouched:g.setTouched,setDirty:g.setDirty,isTouched:g.isTouched,resetTouched:g.resetTouched,isDirty:g.isDirty,getTouched:g.getTouched,getDirty:g.getDirty,reorderListItem:D.reorderListItem,insertListItem:D.insertListItem,removeListItem:D.removeListItem,replaceListItem:D.replaceListItem,reset:Q,validate:G,validateField:ie,getInputProps:le,onSubmit:ae,onReset:de,isValid:ye,getTransformedValues:fe,key:be,getInputNode:Ve};return Fe(t,H),H}export{_e as u,Pe as z};
