import{aa as N,ab as S,r as E,m as g,j as e,S as k,ac as c,ad as M,Q as R,e as P,d as w,ae as O,k as z,T as p,X as F,p as I,i as H}from"./index-CfRCOMrA.js";import{P as L}from"./page-CnaQ1W4y.js";import{P as G}from"./page-header-B11kLpii.js";import{D as i,A as U}from"./index-mzW5VRmb.js";import{u as D,a as q,b as Q,c as Y}from"./employees-YyIPE792.js";import{F as x,T as B,S as C}from"./form-section-eRL7bVNt.js";import{u as J,z as K}from"./use-form-WLabE1qg.js";import{G as n,D as V}from"./DatePickerInput-CdnxYZQB.js";import"./Title-D6Vm42iA.js";import"./Anchor-BeeCN-bx.js";import"./index-CmvIVydS.js";function W(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof Date)}function _(t){if(W(t)){const l={};for(const r in t){const d=t[r];d===""?l[r]=null:l[r]=_(d)}return l}return t}const X=[{value:"HSE",label:"HSE"},{value:"Finance",label:"Finance"},{value:"Operation",label:"Operation"},{value:"IT",label:"IT"},{value:"Engineering",label:"Engineering"},{value:"Procurement",label:"Procurement"},{value:"HR",label:"HR"},{value:"Maintenance",label:"Maintenance"},{value:"QA/QC",label:"QA/QC"},{value:"Safety",label:"Safety"},{value:"Other",label:"Other"}];function v({employeeId:t,onSuccess:l}){const r=!!t,{data:d}=D(),s=d==null?void 0:d.find(m=>m.id===t),{mutate:j,isPending:b}=q(),{mutate:y,isPending:u}=Q(),o=J({validate:K(r?N:S)});E.useEffect(()=>{s&&r&&o.setValues({name:s.name,username:s.username,employee_num:s.employee_num,email:s.email,nik:s.nik,position:s.position,department:s.department,phone_number:s.phone_number,hire_date:s.hire_date?new Date(s.hire_date):null,address:s.address,emergency_contact_name:s.emergency_contact_name,emergency_contact_phone:s.emergency_contact_phone,password:"",role:s.role})},[s,r]);const h=o.onSubmit(m=>{r&&t?y({id:t,data:_(m)},{onSuccess:()=>{g.close("employee-edit"),l==null||l()}}):j(m,{onSuccess:()=>{g.close("employee-create"),l==null||l()}})});return e.jsx("form",{onSubmit:h,children:e.jsxs(k,{gap:"md",children:[e.jsx(x,{title:"Basic Information",children:e.jsxs(n,{children:[e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Full Name",placeholder:"e.g. John Doe",description:"Employee's full name",required:!r,...o.getInputProps("name")})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Username",placeholder:"e.g. johndoe",description:"Used for login",required:!r,...o.getInputProps("username")})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Employee Number",placeholder:"e.g. EMP-001",description:"Unique employee identifier",...o.getInputProps("employee_num")})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"NIK (National ID)",placeholder:"e.g. 1234567890123456",description:"Indonesian National ID number",...o.getInputProps("nik")})})]})}),e.jsx(x,{title:"Contact Information",children:e.jsxs(n,{children:[e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Email Address",placeholder:"e.g. john.doe@company.com",type:"email",description:"Work email address",...o.getInputProps("email")})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Phone Number",placeholder:"e.g. +62 812-3456-7890",type:"tel",description:"Mobile or work phone",...o.getInputProps("phone_number")})}),e.jsx(n.Col,{span:12,children:e.jsx(B,{label:"Address",placeholder:"Enter full address",description:"Residential address",minRows:2,...o.getInputProps("address")})})]})}),e.jsx(x,{title:"Employment Information",children:e.jsxs(n,{children:[e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Position / Job Title",placeholder:"e.g. Senior Engineer, Manager",description:"Current job position",...o.getInputProps("position")})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(C,{label:"Department",placeholder:"Select department",description:"Employee's department",data:X,searchable:!0,clearable:!0,...o.getInputProps("department"),comboboxProps:{zIndex:2001}})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(V,{label:"Hire Date",placeholder:"Select hire date",description:"Date employee was hired",valueFormat:"DD/MM/YYYY",clearable:!0,...o.getInputProps("hire_date"),popoverProps:{zIndex:2001}})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(C,{label:"Role",placeholder:"Select role",description:"System access level",required:!0,data:[{value:"EMPLOYEE",label:"Employee"},{value:"MANAGER",label:"Manager"}],...o.getInputProps("role"),comboboxProps:{zIndex:2001}})})]})}),e.jsx(x,{title:"Emergency Contact",children:e.jsxs(n,{children:[e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Emergency Contact Name",placeholder:"e.g. Jane Doe (Spouse)",description:"Name of person to contact in emergency",...o.getInputProps("emergency_contact_name")})}),e.jsx(n.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Emergency Contact Phone",placeholder:"e.g. +62 812-9876-5432",type:"tel",description:"Emergency contact's phone number",...o.getInputProps("emergency_contact_phone")})})]})}),e.jsx(x,{title:"Credentials",children:e.jsx(n,{children:e.jsx(n.Col,{span:12,children:e.jsx(M,{label:"Password",placeholder:r?"Leave blank to keep current password":"Enter password",description:r?"Only enter if you want to change the password":"Password for login access",required:!r,...o.getInputProps("password")})})})}),e.jsxs(R,{justify:"flex-end",mt:"md",children:[e.jsx(P,{variant:"subtle",onClick:()=>g.close(r?"employee-edit":"employee-create"),children:"Cancel"}),e.jsxs(P,{type:"submit",loading:b||u,children:[r?"Update":"Create"," Employee"]})]})]})})}function Z(t){g.open({modalId:"employee-create",title:"Create Employee",size:"lg",children:e.jsx(v,{onSuccess:t})})}function $(t,l){g.open({modalId:"employee-edit",title:"Edit Employee",size:"lg",children:e.jsx(v,{employeeId:t,onSuccess:l})})}function ee(){const{user:t}=w(),l=O(),{page:r,limit:d,setLimit:s,setPage:j}=z(),{filters:b,sort:y}=i.useDataTable({sortConfig:{direction:"asc",column:"name"}}),{data:u,isLoading:o,refetch:h}=D(),{mutate:m}=Y(),f=E.useCallback(a=>{g.openConfirmModal({title:"Delete Employee",children:"Are you sure you want to delete this employee?",confirmProps:{color:"red"},labels:{confirm:"Delete",cancel:"Cancel"},onConfirm:()=>{m({route:{id:a}}),h()}})},[m,h]),T=E.useMemo(()=>[{accessor:"name",title:"Name",sortable:!0},{accessor:"username",title:"Username",sortable:!0},{accessor:"employee_num",title:"Employee #",render:({employee_num:a})=>a||e.jsx(p,{c:"dimmed",children:"-"})},{accessor:"email",title:"Email",render:({email:a})=>a||e.jsx(p,{c:"dimmed",children:"-"})},{accessor:"nik",title:"NIK",render:({nik:a})=>a||e.jsx(p,{c:"dimmed",children:"-"})},{accessor:"position",title:"Position",render:({position:a})=>a||e.jsx(p,{c:"dimmed",children:"-"})},{accessor:"department",title:"Department",render:({department:a})=>a||e.jsx(p,{c:"dimmed",children:"-"})},{accessor:"phone_number",title:"Phone",render:({phone_number:a})=>a||e.jsx(p,{c:"dimmed",children:"-"})},{accessor:"role",title:"Role",sortable:!0,render:({role:a})=>e.jsx(F,{color:a==="MANAGER"?"blue":"gray",children:a})},{accessor:"id",title:"User ID",render:({id:a})=>e.jsxs(p,{size:"xs",children:[a.slice(0,8),"..."]})},{accessor:"actions",title:"Actions",textAlign:"right",width:130,render:a=>e.jsx(i.Actions,{onView:()=>l(I.manager.employeeDetail(a.id)),onEdit:()=>$(a.id,h),onDelete:a.id!==(t==null?void 0:t.id)?()=>f(a.id):void 0})}],[t==null?void 0:t.id,f,l]),A=H.users;return e.jsxs(i.Container,{children:[e.jsx(i.Title,{icon:e.jsx(A,{size:25}),title:"Employees",actions:e.jsx(U,{variant:"default",size:"xs",onClick:()=>Z(h),children:"Add Employee"})}),e.jsx(i.Filters,{filters:b.filters,onClear:b.clear}),e.jsx(i.Content,{children:e.jsx(i.Table,{striped:!0,minHeight:240,noRecordsText:i.noRecordsText("employees"),recordsPerPageLabel:i.recordsPerPageLabel("employees"),paginationText:i.paginationText("employees"),page:r,records:u??[],fetching:o,onPageChange:j,recordsPerPage:d,totalRecords:(u==null?void 0:u.length)??0,onRecordsPerPageChange:s,recordsPerPageOptions:[5,15,30],sortStatus:y.status,onSortStatusChange:y.change,columns:T,pinLastColumn:!0,highlightOnHover:!0})})]})}const te=[{label:"Employees",href:I.manager.employees},{label:"List"}];function ue(){return e.jsxs(L,{title:"Employees",children:[e.jsx(G,{title:"Employee Management",breadcrumbs:te}),e.jsx(ee,{})]})}export{ue as default};
