import{aj as j,ak as b,cg as y,W as h,d as g,r as P,j as e,S as c,ad as i,ae as _,Q as f,e as w,ch as C,p as x,P as I,X as N,T as t,ah as E}from"./index--ClWZahu.js";import{P as S}from"./page-CknD4dKm.js";import{P as k}from"./page-header-BWjuV_E8.js";import{F as d,G as s,T as A}from"./form-section-C5VgLGpa.js";import{e as D}from"./object-4sH1WIyZ.js";import{u as T,z}from"./use-form-L8LbUW_M.js";import{T as u}from"./Title-Ci985OzB.js";import"./Anchor-DIBe1ZWb.js";function F(){const n=j();return b({mutationFn:l=>y(l),onSuccess:()=>{n.invalidateQueries({queryKey:["account-info"]}),h.show({title:"Success",message:"Profile updated successfully",color:"green"})},onError:()=>{h.show({title:"Error",message:"Failed to update profile",color:"red"})}})}function U(){const{user:n}=g(),{mutate:l,isPending:p}=F(),o=T({validate:z(C)});P.useEffect(()=>{n&&o.setValues({username:n.username,name:n.name,nik:n.nik,email:n.email,phone_number:n.phone_number,address:n.address,emergency_contact_name:n.emergency_contact_name,emergency_contact_phone:n.emergency_contact_phone,password:""})},[n]);const m=o.onSubmit(r=>{const a={};r.username!==(n==null?void 0:n.username)&&(a.username=r.username),r.name!==(n==null?void 0:n.name)&&(a.name=r.name),r.nik!==(n==null?void 0:n.nik)&&(a.nik=r.nik),r.email!==(n==null?void 0:n.email)&&(a.email=r.email),r.phone_number!==(n==null?void 0:n.phone_number)&&(a.phone_number=r.phone_number),r.address!==(n==null?void 0:n.address)&&(a.address=r.address),r.emergency_contact_name!==(n==null?void 0:n.emergency_contact_name)&&(a.emergency_contact_name=r.emergency_contact_name),r.emergency_contact_phone!==(n==null?void 0:n.emergency_contact_phone)&&(a.emergency_contact_phone=r.emergency_contact_phone),r.password&&r.password.trim()!==""&&(a.password=r.password),l(D(a),{onSuccess:()=>{o.setFieldValue("password","")}})});return e.jsx("form",{onSubmit:m,children:e.jsxs(c,{gap:"md",children:[e.jsx(d,{title:"Account Information",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"Username",placeholder:"e.g. johndoe",description:"Your login username",...o.getInputProps("username")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(_,{label:"New Password",placeholder:"Leave blank to keep current password",description:"Only enter if you want to change your password",...o.getInputProps("password")})})]})}),e.jsx(d,{title:"Personal Information",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"Full Name",placeholder:"e.g. John Doe",description:"Your full name",...o.getInputProps("name")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"NIK (National ID)",placeholder:"e.g. 1234567890123456",description:"Indonesian National ID number",...o.getInputProps("nik")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"Email Address",placeholder:"e.g. john.doe@company.com",type:"email",description:"Your email address",...o.getInputProps("email")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"Phone Number",placeholder:"e.g. +62 812-3456-7890",type:"tel",description:"Your mobile or work phone",...o.getInputProps("phone_number")})}),e.jsx(s.Col,{span:12,children:e.jsx(A,{label:"Address",placeholder:"Enter your full address",description:"Your residential address",minRows:2,...o.getInputProps("address")})})]})}),e.jsx(d,{title:"Emergency Contact",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"Emergency Contact Name",placeholder:"e.g. Jane Doe (Spouse)",description:"Name of person to contact in emergency",...o.getInputProps("emergency_contact_name")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(i,{label:"Emergency Contact Phone",placeholder:"e.g. +62 812-9876-5432",type:"tel",description:"Emergency contact's phone number",...o.getInputProps("emergency_contact_phone")})})]})}),e.jsx(f,{justify:"flex-end",mt:"md",children:e.jsx(w,{type:"submit",loading:p,children:"Update Profile"})})]})})}function J(){var m;const{user:n}=g();if(!n)return null;const l=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",o=[{label:"Profile",href:n.role==="MANAGER"?x.manager.profile:x.employee.profile}];return e.jsxs(S,{title:"Profile",children:[e.jsx(k,{title:"My Profile",breadcrumbs:o}),e.jsxs(c,{gap:"xl",children:[e.jsxs(I,{p:"md",withBorder:!0,children:[e.jsxs(f,{justify:"space-between",align:"center",mb:"md",children:[e.jsx(u,{order:4,children:"Employment Information"}),e.jsx(N,{size:"lg",variant:"light",color:n.role==="MANAGER"?"blue":"green",children:n.role})]}),e.jsx(t,{size:"sm",c:"dimmed",mb:"lg",children:"The following information can only be changed by a manager"}),e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6,md:4},children:e.jsxs(c,{gap:"xs",children:[e.jsx(t,{size:"sm",fw:500,c:"dimmed",children:"Position"}),e.jsx(t,{children:n.position||"N/A"})]})}),e.jsx(s.Col,{span:{base:12,sm:6,md:4},children:e.jsxs(c,{gap:"xs",children:[e.jsx(t,{size:"sm",fw:500,c:"dimmed",children:"Department"}),e.jsx(t,{children:n.department||"N/A"})]})}),e.jsx(s.Col,{span:{base:12,sm:6,md:4},children:e.jsxs(c,{gap:"xs",children:[e.jsx(t,{size:"sm",fw:500,c:"dimmed",children:"Employee Number"}),e.jsx(t,{children:n.employee_num||"N/A"})]})}),e.jsx(s.Col,{span:{base:12,sm:6,md:4},children:e.jsxs(c,{gap:"xs",children:[e.jsx(t,{size:"sm",fw:500,c:"dimmed",children:"Hire Date"}),e.jsx(t,{children:l((m=n.hire_date)==null?void 0:m.toString())})]})})]})]}),e.jsxs(E,{withBorder:!0,children:[e.jsx(u,{order:4,mb:"md",children:"Update Personal Information"}),e.jsx(U,{})]})]})]})}export{J as default};
