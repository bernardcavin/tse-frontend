import{Z as B,_ as i,aG as Q,au as _,aK as q,av as A,a5 as y,W as u,a2 as M,a3 as T,a4 as G,a6 as H,ai as O,j as e,a7 as C,T as b,S as g,Q as z,e as S,r as N,m as j}from"./index--ClWZahu.js";import{F as x,G as o}from"./form-section-C5VgLGpa.js";import{S as V,T as Z}from"./text-area-CTQii59r.js";import{T as d}from"./text-input-BLEms8uL.js";import{h as v,F as w}from"./form-CN9S1QwI.js";import{u as E,z as F}from"./use-form-L8LbUW_M.js";import{I as D,a as J}from"./IconPlus-BmH8SaqF.js";const p=B({id:i().uuid().optional().nullable(),name:i().min(1,"Name is required"),email:i().optional().nullable(),phone:i().optional().nullable(),position:i().optional().nullable(),company:i().optional().nullable(),regional:Q.number().optional().nullable(),zone:i().optional().nullable(),field:i().optional().nullable(),address:i().optional().nullable(),notes:i().optional().nullable()});function L(a){return a==null||a===0?"-":`Regional ${a}`}async function $(){const a=await _.get("contacts/utils/zones");return q.array().parse(A.parse(a.data).data)}const re=M({endpoint:"/contacts",dataSchema:p,rQueryParams:{queryKey:["contacts"]}}),P=G({endpoint:"/contacts/:id",responseSchema:p,rQueryParams:{queryKey:["contact"]}}),W=y({endpoint:"/contacts",bodySchema:p,rMutationParams:{onSuccess:(a,n,l,s)=>{s.invalidateQueries({queryKey:["contacts"]}),u.show({title:"Berhasil",message:"Kontak berhasil dibuat",color:"green"})},onError:a=>{u.show({message:a.message,color:"red"})}},options:{isMultipart:!1}}),U=H({endpoint:"/contacts/:id",bodySchema:p,rMutationParams:{onSuccess:(a,n,l,s)=>{s.invalidateQueries({queryKey:["contacts"]}),s.invalidateQueries({queryKey:["contact"]}),u.show({title:"Berhasil",message:"Kontak berhasil diubah",color:"green"})},onError:a=>{u.show({message:a.message,color:"red"})}}}),ce=T({endpoint:"/contacts/:id",rMutationParams:{onSuccess:(a,n,l,s)=>{s.invalidateQueries({queryKey:["contacts"]}),u.show({title:"Berhasil",message:"Kontak berhasil dihapus",color:"green"})},onError:a=>{u.show({message:a.message,color:"red"})}}}),k=()=>O({queryKey:["zone-options"],queryFn:$}),de=y({endpoint:"/contacts/bulk",bodySchema:p.array(),rMutationParams:{onSuccess:(a,n,l,s)=>{var t;s.invalidateQueries({queryKey:["contacts"]}),s.invalidateQueries({queryKey:["zone-options"]}),u.show({title:"Berhasil",message:`${((t=a==null?void 0:a.data)==null?void 0:t.created)||0} kontak berhasil diimport`,color:"green"})},onError:a=>{u.show({message:a.message,color:"red"})}},options:{isMultipart:!1}});function r({label:a,value:n}){return e.jsxs(o.Col,{span:{base:12,sm:6},children:[e.jsx(b,{size:"sm",c:"dimmed",children:a}),e.jsx(b,{size:"md",fw:500,children:n||"-"})]})}function X({id:a}){const{data:n,isLoading:l}=P({route:{id:a}});return l?e.jsx(C,{color:"blue",size:"xl"}):n?e.jsxs(g,{gap:"md",children:[e.jsx(x,{title:"Basic Information",children:e.jsxs(o,{children:[e.jsx(r,{label:"Nama",value:n.name}),e.jsx(r,{label:"Jabatan",value:n.position}),e.jsx(r,{label:"Email",value:n.email}),e.jsx(r,{label:"No. Hp",value:n.phone})]})}),e.jsx(x,{title:"Organization",children:e.jsxs(o,{children:[e.jsx(r,{label:"Perusahaan",value:n.company}),e.jsx(r,{label:"Regional",value:L(n.regional)}),e.jsx(r,{label:"Zona",value:n.zone}),e.jsx(r,{label:"Field",value:n.field})]})}),e.jsx(x,{title:"Additional Information",children:e.jsxs(o,{children:[e.jsx(r,{label:"Address",value:n.address}),e.jsxs(o.Col,{span:12,children:[e.jsx(b,{size:"sm",c:"dimmed",children:"Notes"}),e.jsx(b,{size:"md",fw:500,children:n.notes||"-"})]})]})})]}):e.jsx(b,{children:"Contact not found"})}function Y({onSubmit:a}){const{mutate:n,isPending:l}=W(),{data:s=[]}=k(),t=E({mode:"controlled",validate:F(p),transformValues:m=>({...m,regional:m.regional?parseInt(String(m.regional),10):null})}),f=t.onSubmit(m=>{n({variables:m},{onError:h=>v(t,h),onSuccess:()=>{a()}})});return e.jsx(w,{form:t,onSubmit:f,children:e.jsxs(g,{children:[e.jsx(I,{zoneOptions:s}),e.jsx(z,{justify:"flex-end",children:e.jsx(S,{type:"submit",loading:l,mt:"md",leftSection:e.jsx(D,{size:16,stroke:5}),children:"Add"})})]})})}function ee({onSubmit:a,id:n}){const{mutate:l,isPending:s}=U({route:{id:n}}),{data:t,isLoading:f}=P({route:{id:n}}),{data:m=[]}=k(),h=E({mode:"controlled",validate:F(p),transformValues:c=>({...c,regional:c.regional?parseInt(String(c.regional),10):null})});N.useEffect(()=>{var c;t&&h.setValues({...t,regional:((c=t.regional)==null?void 0:c.toString())??null})},[t]);const R=h.onSubmit(c=>{l({variables:c},{onError:K=>v(h,K),onSuccess:()=>{a()}})});return f?e.jsx(C,{color:"blue",size:"xl"}):e.jsx(w,{form:h,onSubmit:R,children:e.jsxs(g,{children:[e.jsx(I,{zoneOptions:m}),e.jsx(z,{justify:"flex-end",children:e.jsx(S,{type:"submit",loading:s,mt:"md",leftSection:e.jsx(J,{size:16,stroke:2}),children:"Save"})})]})})}function I({zoneOptions:a}){return e.jsxs(g,{gap:"md",children:[e.jsx(x,{title:"Basic Information",children:e.jsxs(o,{children:[e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"name",label:"Nama",placeholder:"Contact name",required:!0,description:"Full name of the contact"})}),e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"position",label:"Jabatan",placeholder:"e.g. Manager, Engineer",description:"Job title or position"})}),e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"email",label:"Email",placeholder:"email@example.com",description:"Email address"})}),e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"phone",label:"No. Hp",placeholder:"+62 812 3456 7890",description:"Phone number"})})]})}),e.jsx(x,{title:"Organization",children:e.jsxs(o,{children:[e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"company",label:"Perusahaan",placeholder:"Company name",description:"Company or organization name"})}),e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(V,{name:"regional",label:"Regional",placeholder:"Select regional",description:"Regional area (0 = none)",data:[{value:"0",label:"-"},{value:"1",label:"Regional 1"},{value:"2",label:"Regional 2"},{value:"3",label:"Regional 3"},{value:"4",label:"Regional 4"}],searchable:!0,comboboxProps:{zIndex:2e3}})}),e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"zone",label:"Zona",placeholder:"Type zone name",description:"Zone area"})}),e.jsx(o.Col,{span:{base:12,sm:6},children:e.jsx(d,{name:"field",label:"Field",placeholder:"Field name",description:"Field or project area"})})]})}),e.jsx(x,{title:"Additional Information",withHide:!0,children:e.jsxs(o,{children:[e.jsx(o.Col,{span:12,children:e.jsx(d,{name:"address",label:"Address",placeholder:"Full address",description:"Physical address"})}),e.jsx(o.Col,{span:12,children:e.jsx(Z,{name:"notes",label:"Notes",placeholder:"Additional notes",autosize:!0,minRows:2,description:"Any additional information"})})]})})]})}function ue(a){j.open({title:"Add new contact",children:e.jsx(Y,{onSubmit:()=>{a(),j.closeAll()}}),size:"60rem",zIndex:2e3,withCloseButton:!1})}function me(a,n){j.open({title:"Edit contact",children:e.jsx(ee,{id:a,onSubmit:()=>{n(),j.closeAll()}}),size:"60rem",zIndex:2e3,withCloseButton:!1})}function pe(a){j.open({title:"View contact",children:e.jsx(X,{id:a}),size:"60rem",zIndex:2e3,withCloseButton:!1})}export{re as a,ce as b,pe as c,me as d,L as f,ue as o,de as u};
