import{ag as je,r as o,j as e,Q as r,a7 as b,p as W,S as n,ah as c,T as t,o as j,h as I,e as C,X as M}from"./index--ClWZahu.js";import{u as pe,a as ue}from"./hazard-observations-modals-DFQca6Bj.js";import{u as ge,I as fe}from"./it-tickets-DsHk8ugn.js";import{P as X}from"./page-CknD4dKm.js";import{P as ye}from"./page-header-BWjuV_E8.js";import{u as we}from"./attendance-Ds-IZYDR.js";import{u as ve}from"./employees-CTMYvjS9.js";import{W as E}from"./index-Bn0zxFJ3.js";import{T}from"./Title-Ci985OzB.js";import{G as d}from"./form-section-C5VgLGpa.js";import{c as H}from"./createReactComponent-BM7tdotx.js";import{I as P}from"./IconFileAlert-IqUr3CM8.js";import{I as v}from"./IconTicket-CR3jGm9-.js";import{D as L}from"./DatePickerInput-BeLOAKO0.js";import{I as B}from"./IconX-DuMbzP0j.js";import"./date-CCyo-1EX.js";import"./file-upload-DQ7A5yty.js";import"./form-CN9S1QwI.js";import"./IconCheck-DpEWvlmQ.js";import"./facilities-BJtlO5v9.js";import"./facility-CsGiLvNK.js";import"./use-form-L8LbUW_M.js";import"./IconPlus-BmH8SaqF.js";import"./Select-UMZ64bLE.js";import"./Anchor-DIBe1ZWb.js";/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var z=H("outline","calendar","IconCalendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ze=H("outline","clipboard-list","IconClipboardList",[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M9 12l.01 0",key:"svg-2"}],["path",{d:"M13 12l2 0",key:"svg-3"}],["path",{d:"M9 16l.01 0",key:"svg-4"}],["path",{d:"M13 16l2 0",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ke=H("outline","eye","IconEye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]]);function Ke(){var $,F;const{id:m}=je(),[p,R]=o.useState([null,null]),[h,A]=o.useState([null,null]),[x,O]=o.useState([null,null]),[q,K]=o.useState(1),[Q,Z]=o.useState(1),[J,Y]=o.useState(1),D=10,{data:k,isLoading:ee}=ve(),a=o.useMemo(()=>k==null?void 0:k.find(s=>s.id===m),[k,m]),{data:l,isLoading:G}=we({query:{user_id:m,start_date:p[0]?p[0].toString():void 0,end_date:p[1]?p[1].toString():void 0}}),{data:g,isLoading:U}=pe(),{data:f,isLoading:N}=ge(),y=o.useMemo(()=>{if(!(g!=null&&g.data))return[];let s=g.data.filter(i=>i.observer_id===m);return h[0]&&(s=s.filter(i=>new Date(i.observation_date)>=h[0])),h[1]&&(s=s.filter(i=>new Date(i.observation_date)<=h[1])),s},[g,m,h]),u=o.useMemo(()=>{if(!(f!=null&&f.data))return[];let s=f.data.filter(i=>i.reporter_id===m);return x[0]&&(s=s.filter(i=>new Date(i.created_at)>=x[0])),x[1]&&(s=s.filter(i=>new Date(i.created_at)<=x[1])),s},[f,m,x]);if(ee||!a)return e.jsx(X,{title:"Employee Details",children:e.jsx(r,{justify:"center",py:"xl",children:e.jsx(b,{size:"lg"})})});const se=[{label:"Employees",href:W.manager.employees},{label:a.name||"Employee Details",href:W.manager.employeeDetail(m)}],te=(s,i)=>{if(!i)return"-";const _=i.getTime()-s.getTime(),w=Math.floor(_/(1e3*60*60)),S=Math.floor(_%(1e3*60*60)/(1e3*60));return`${w}h ${S}m`},V=o.useMemo(()=>{if(!(l!=null&&l.data))return{hours:0,minutes:0};let s=0;l.data.forEach(w=>{if(w.check_out_time){const S=new Date(w.check_out_time).getTime()-new Date(w.check_in_time).getTime();s+=S}});const i=Math.floor(s/(1e3*60*60)),_=Math.floor(s%(1e3*60*60)/(1e3*60));return{hours:i,minutes:_}},[l]),ie=(($=l==null?void 0:l.data)==null?void 0:$.length)||0,re=y.length,ae=y.filter(s=>s.status==="open").length,ne=y.filter(s=>s.status==="resolved").length,le=u.length,ce=u.filter(s=>s.status==="open").length,de=u.filter(s=>s.status==="in_progress").length,oe=u.filter(s=>s.status==="resolved"||s.status==="closed").length,me=[{accessor:"check_in_time",title:"Date",render:s=>new Date(s.check_in_time).toLocaleDateString()},{accessor:"check_in_time",title:"Check In",render:s=>new Date(s.check_in_time).toLocaleTimeString()},{accessor:"check_out_time",title:"Check Out",render:s=>s.check_out_time?new Date(s.check_out_time).toLocaleTimeString():"-"},{accessor:"duration",title:"Duration",render:s=>te(new Date(s.check_in_time),s.check_out_time?new Date(s.check_out_time):null)},{accessor:"location_name",title:"Location",render:s=>s.location_name||"-"}],he=[{accessor:"observation_date",title:"Date",render:s=>new Date(s.observation_date).toLocaleDateString()},{accessor:"facility_name",title:"Facility",render:s=>s.facility_name||s.facility_id},{accessor:"unsafe_action_condition",title:"Description",ellipsis:!0},{accessor:"status",title:"Status",render:s=>{var i;return e.jsx(M,{color:s.status==="open"?"red":s.status==="in_progress"?"yellow":s.status==="resolved"?"green":"gray",children:(i=s.status)==null?void 0:i.replace("_"," ").toUpperCase()})}},{accessor:"actions",title:"Actions",width:100,render:s=>e.jsx(C,{size:"xs",variant:"subtle",leftSection:e.jsx(ke,{size:14}),onClick:()=>ue(s.id),children:"View"})}],xe=[{accessor:"created_at",title:"Date",render:s=>new Date(s.created_at).toLocaleDateString()},{accessor:"title",title:"Title",ellipsis:!0},{accessor:"category",title:"Category",render:s=>{var i;return(i=s.category)==null?void 0:i.replace("_"," ").toUpperCase()}},{accessor:"priority",title:"Priority",render:s=>{var i;return e.jsx(M,{color:s.priority==="critical"?"red":s.priority==="high"?"orange":s.priority==="medium"?"yellow":"blue",children:(i=s.priority)==null?void 0:i.toUpperCase()})}},{accessor:"status",title:"Status",render:s=>{var i;return e.jsx(M,{color:s.status==="open"?"red":s.status==="in_progress"?"yellow":s.status==="resolved"||s.status==="closed"?"green":"gray",children:(i=s.status)==null?void 0:i.replace("_"," ").toUpperCase()})}},{accessor:"assigned_to_name",title:"Assigned To",render:s=>s.assigned_to_name||"-"}];return e.jsxs(X,{title:`Employee: ${a.name}`,children:[e.jsx(ye,{title:a.name||"Employee Details",breadcrumbs:se}),e.jsxs(n,{gap:"lg",children:[e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(n,{gap:"md",children:[e.jsxs(r,{children:[e.jsx(fe,{size:24}),e.jsx(T,{order:3,children:"Employee Information"})]}),e.jsxs(d,{children:[e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Name"}),e.jsx(t,{fw:500,children:a.name||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Username"}),e.jsx(t,{fw:500,children:a.username||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Employee Number"}),e.jsx(t,{fw:500,children:a.employee_num||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"NIK"}),e.jsx(t,{fw:500,children:a.nik||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Email"}),e.jsx(t,{fw:500,children:a.email||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Phone Number"}),e.jsx(t,{fw:500,children:a.phone_number||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Department"}),e.jsx(t,{fw:500,children:a.department||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Position"}),e.jsx(t,{fw:500,children:a.position||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Hire Date"}),e.jsx(t,{fw:500,children:a.hire_date?new Date(a.hire_date).toLocaleDateString():"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Address"}),e.jsx(t,{fw:500,children:a.address||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Emergency Contact"}),e.jsx(t,{fw:500,children:a.emergency_contact_name||"-"})]}),e.jsxs(d.Col,{span:{base:12,sm:6,md:3},children:[e.jsx(t,{size:"sm",c:"dimmed",children:"Emergency Phone"}),e.jsx(t,{fw:500,children:a.emergency_contact_phone||"-"})]})]})]})}),e.jsxs(j,{defaultValue:"attendance",children:[e.jsxs(j.List,{children:[e.jsx(j.Tab,{value:"attendance",leftSection:e.jsx(ze,{size:16}),children:"Attendance"}),e.jsx(j.Tab,{value:"hazards",leftSection:e.jsx(P,{size:16}),children:"Hazard Observations"}),e.jsx(j.Tab,{value:"tickets",leftSection:e.jsx(v,{size:16}),children:"IT Tickets"})]}),e.jsx(j.Panel,{value:"attendance",pt:"lg",children:e.jsxs(n,{gap:"lg",children:[e.jsxs(I,{cols:{base:1,sm:2},children:[e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Total Attendance Days"}),e.jsx(t,{size:"xl",fw:700,children:ie})]}),e.jsx(z,{size:32,stroke:1.5,color:"var(--mantine-color-blue-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Total Duration"}),e.jsxs(t,{size:"xl",fw:700,children:[V.hours,"h ",V.minutes,"m"]})]}),e.jsx(z,{size:32,stroke:1.5,color:"var(--mantine-color-cyan-6)"})]})})]}),e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(n,{gap:"md",children:[e.jsxs(r,{justify:"space-between",children:[e.jsx(T,{order:4,children:"Attendance Records"}),e.jsxs(r,{gap:"sm",children:[e.jsx(L,{type:"range",placeholder:"Pick date range",value:p,onChange:R,clearable:!0,size:"xs",leftSection:e.jsx(z,{size:16})}),(p[0]||p[1])&&e.jsx(C,{size:"xs",variant:"subtle",color:"gray",onClick:()=>R([null,null]),leftSection:e.jsx(B,{size:14}),children:"Clear"})]})]}),G?e.jsx(r,{justify:"center",py:"xl",children:e.jsx(b,{})}):e.jsx(E,{withTableBorder:!1,mih:200,columns:me,records:(l==null?void 0:l.data)||[],totalRecords:((F=l==null?void 0:l.meta)==null?void 0:F.total)||0,fetching:G,page:q,onPageChange:K,recordsPerPage:D})]})})]})}),e.jsx(j.Panel,{value:"hazards",pt:"lg",children:e.jsxs(n,{gap:"lg",children:[e.jsxs(I,{cols:{base:1,sm:3},children:[e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Total HOCs"}),e.jsx(t,{size:"xl",fw:700,children:re})]}),e.jsx(P,{size:32,stroke:1.5,color:"var(--mantine-color-violet-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Open HOCs"}),e.jsx(t,{size:"xl",fw:700,children:ae})]}),e.jsx(P,{size:32,stroke:1.5,color:"var(--mantine-color-red-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Resolved HOCs"}),e.jsx(t,{size:"xl",fw:700,children:ne})]}),e.jsx(P,{size:32,stroke:1.5,color:"var(--mantine-color-green-6)"})]})})]}),e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(n,{gap:"md",children:[e.jsxs(r,{justify:"space-between",children:[e.jsx(T,{order:4,children:"Hazard Observation Cards"}),e.jsxs(r,{gap:"sm",children:[e.jsx(L,{type:"range",placeholder:"Pick date range",value:h,onChange:A,clearable:!0,size:"xs",leftSection:e.jsx(z,{size:16})}),(h[0]||h[1])&&e.jsx(C,{size:"xs",variant:"subtle",color:"gray",onClick:()=>A([null,null]),leftSection:e.jsx(B,{size:14}),children:"Clear"})]})]}),U?e.jsx(r,{justify:"center",py:"xl",children:e.jsx(b,{})}):e.jsx(E,{withTableBorder:!1,mih:200,columns:he,records:y,totalRecords:y.length,fetching:U,page:Q,onPageChange:Z,recordsPerPage:D})]})})]})}),e.jsx(j.Panel,{value:"tickets",pt:"lg",children:e.jsxs(n,{gap:"lg",children:[e.jsxs(I,{cols:{base:1,sm:2,md:4},children:[e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Total Tickets"}),e.jsx(t,{size:"xl",fw:700,children:le})]}),e.jsx(v,{size:32,stroke:1.5,color:"var(--mantine-color-violet-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Open Tickets"}),e.jsx(t,{size:"xl",fw:700,children:ce})]}),e.jsx(v,{size:32,stroke:1.5,color:"var(--mantine-color-red-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"In Progress"}),e.jsx(t,{size:"xl",fw:700,children:de})]}),e.jsx(v,{size:32,stroke:1.5,color:"var(--mantine-color-yellow-6)"})]})}),e.jsx(c,{padding:"md",radius:"md",withBorder:!0,children:e.jsxs(r,{justify:"space-between",children:[e.jsxs(n,{gap:0,children:[e.jsx(t,{size:"xs",c:"dimmed",fw:500,children:"Resolved Tickets"}),e.jsx(t,{size:"xl",fw:700,children:oe})]}),e.jsx(v,{size:32,stroke:1.5,color:"var(--mantine-color-green-6)"})]})})]}),e.jsx(c,{padding:"lg",radius:"md",withBorder:!0,children:e.jsxs(n,{gap:"md",children:[e.jsxs(r,{justify:"space-between",children:[e.jsx(T,{order:4,children:"IT Tickets"}),e.jsxs(r,{gap:"sm",children:[e.jsx(L,{type:"range",placeholder:"Pick date range",value:x,onChange:O,clearable:!0,size:"xs",leftSection:e.jsx(z,{size:16})}),(x[0]||x[1])&&e.jsx(C,{size:"xs",variant:"subtle",color:"gray",onClick:()=>O([null,null]),leftSection:e.jsx(B,{size:14}),children:"Clear"})]})]}),N?e.jsx(r,{justify:"center",py:"xl",children:e.jsx(b,{})}):e.jsx(E,{withTableBorder:!1,mih:200,columns:xe,records:u,totalRecords:u.length,fetching:N,page:J,onPageChange:Y,recordsPerPage:D})]})})]})})]})]})]})}export{Ke as default};
