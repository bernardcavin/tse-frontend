import{a2 as H,a3 as T,W as d,a4 as q,a5 as O,a6 as A,j as e,Q as y,a7 as F,T as j,S as p,a8 as D,P as N,B as Q,aa as R,e as v,r as G,m as h}from"./index--ClWZahu.js";import{Q as J,M as V,T as K,a as U,L as W}from"./index-Cc0-q_aR.js";import{F as c,G as t}from"./form-section-C5VgLGpa.js";import{C as Y,u as S,F as w,I as Z}from"./file-upload-DQ7A5yty.js";import{F as u}from"./facility-CsGiLvNK.js";import{P as X}from"./Popup-Ut2PlrAf.js";import{u as P,z as I}from"./use-form-L8LbUW_M.js";import{S as $,T as ee,N as C}from"./text-area-CTQii59r.js";import{T as o}from"./text-input-BLEms8uL.js";import{h as _,F as M}from"./form-CN9S1QwI.js";import{I as ie,a as ae}from"./IconPlus-BmH8SaqF.js";const be=H({endpoint:"/facilities",dataSchema:u,rQueryParams:{queryKey:["facilities"]}}),z=q({endpoint:"/facilities/:id",responseSchema:u,rQueryParams:{queryKey:["facility"]}}),te=O({endpoint:"/facilities",bodySchema:u,rMutationParams:{onSuccess:a=>{d.show({title:"Berhasil",message:"Facility berhasil dibuat",color:"green"})},onError:a=>{d.show({message:a.message,color:"red"})}},options:{isMultipart:!1}}),se=A({endpoint:"/facilities/:id",bodySchema:u,rMutationParams:{onSuccess:a=>{d.show({title:"Berhasil",message:"Facility berhasil diubah",color:"green"})},onError:a=>{d.show({message:a.message,color:"red"})}}}),ge=T({endpoint:"/facilities/:id",rMutationParams:{onSuccess:a=>{d.show({title:"Berhasil",message:"Facility berhasil dihapus",color:"green"})},onError:a=>{d.show({message:a.message,color:"red"})}}});function le({id:a}){const{data:l,isLoading:m}=z({route:{id:a}});if(m)return e.jsx(y,{justify:"center",py:"xl",children:e.jsx(F,{size:"lg"})});if(!l)return e.jsx(j,{c:"dimmed",ta:"center",py:"xl",children:"No facility data found."});const i=l,r=i.latitude!==null&&i.longitude!==null;return e.jsxs(p,{gap:"lg",children:[i.photo_file_ids&&i.photo_file_ids.length>0&&e.jsx(c,{title:"Photos",withHide:!0,children:e.jsx(Y,{file_ids:i.photo_file_ids})}),e.jsxs(c,{title:"Facility Information",withHide:!0,children:[i.id&&e.jsx(D,{children:e.jsx(N,{shadow:"xs",p:"md",withBorder:!0,children:e.jsx(J,{value:i.id,size:200})})}),e.jsxs(t,{children:[e.jsxs(t.Col,{span:{base:12,sm:6},children:[e.jsx(s,{label:"Facility Name",value:i.facility_name}),e.jsx(s,{label:"Facility Type",value:i.facility_type}),e.jsx(s,{label:"Owner Company",value:i.owner_company}),e.jsx(s,{label:"Manager Name",value:i.manager_name})]}),e.jsxs(t.Col,{span:{base:12,sm:6},children:[e.jsx(s,{label:"Contact Email",value:i.contact_email}),e.jsx(s,{label:"Contact Phone",value:i.contact_phone}),e.jsx(s,{label:"Description",value:i.description})]})]})]}),e.jsx(c,{title:"Location Details",withHide:!0,children:e.jsxs(t,{children:[e.jsxs(t.Col,{span:{base:12,sm:6},children:[e.jsx(s,{label:"Address",value:i.address}),e.jsx(s,{label:"City",value:i.city}),e.jsx(s,{label:"Province",value:i.province}),e.jsx(s,{label:"Country",value:i.country})]}),e.jsxs(t.Col,{span:{base:12,sm:6},children:[e.jsx(s,{label:"Latitude",value:i.latitude}),e.jsx(s,{label:"Longitude",value:i.longitude})]})]})}),r&&e.jsx(c,{title:"Map Location",withHide:!0,children:e.jsx(Q,{style:{height:300,borderRadius:12,overflow:"hidden"},children:e.jsxs(V,{center:[i.latitude,i.longitude],zoom:13,style:{height:"100%",width:"100%"},scrollWheelZoom:!1,children:[e.jsx(K,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"Â© OpenStreetMap contributors"}),e.jsx(U,{position:[i.latitude,i.longitude],icon:W.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/684/684908.png",iconSize:[30,30]}),children:e.jsxs(X,{children:[e.jsx("strong",{children:i.facility_name}),e.jsx("br",{}),i.address??"No address provided"]})})]})})})]})}function s({label:a,value:l}){return e.jsxs(p,{gap:2,mb:"sm",children:[e.jsx(j,{c:"dimmed",fz:"sm",children:a}),e.jsx(j,{fw:500,style:{wordBreak:"break-word"},children:l??"-"}),e.jsx(R,{my:4})]})}function k(){return e.jsxs(p,{gap:"md",children:[e.jsx(Z,{name:"photo_file_ids",title:"Facility Photos",multiple:!0,description:"Upload photos of the facility"}),e.jsx(c,{title:"Basic Information",children:e.jsxs(t,{children:[e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{name:"facility_name",label:"Facility Name",placeholder:"e.g. Jakarta Main Office, Rig Site Alpha",required:!0,description:"Official name or label for the facility"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx($,{name:"facility_type",label:"Facility Type",placeholder:"Select facility type",required:!0,description:"Type or category of this facility",data:[{value:"office",label:"Office"},{value:"warehouse",label:"Warehouse"},{value:"yard",label:"Yard"},{value:"rig_site",label:"Rig Site"},{value:"plant",label:"Plant"},{value:"other",label:"Other"}],searchable:!0,comboboxProps:{zIndex:2e3}})}),e.jsx(t.Col,{span:12,children:e.jsx(ee,{name:"description",label:"Description",placeholder:"Short summary of the facility, function, or notes",autosize:!0,minRows:2,description:"Provide additional details about the facility"})})]})}),e.jsx(c,{title:"Location Information",children:e.jsxs(t,{children:[e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{required:!0,name:"address",label:"Address",placeholder:"e.g. Jl. Sudirman No. 10",description:"Full street address of the facility"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{required:!0,name:"city",label:"City",placeholder:"e.g. Jakarta",description:"City or municipality"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{required:!0,name:"province",label:"Province/State",placeholder:"e.g. DKI Jakarta",description:"Province or state where the facility is located"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{required:!0,name:"country",label:"Country",placeholder:"e.g. Indonesia",description:"Country of the facility"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(C,{required:!0,name:"latitude",label:"Latitude",placeholder:"e.g. -6.2088",description:"Latitude coordinate",decimalScale:6})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(C,{required:!0,name:"longitude",label:"Longitude",placeholder:"e.g. 106.8456",description:"Longitude coordinate",decimalScale:6})})]})}),e.jsx(c,{title:"Ownership & Management",withHide:!0,children:e.jsxs(t,{children:[e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{name:"owner_company",label:"Owner Company",placeholder:"e.g. Pertamina Hulu Energi",description:"Company that owns or operates this facility"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{name:"manager_name",label:"Facility Manager",placeholder:"e.g. Budi Santoso",description:"Person responsible for the facility operations"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{name:"contact_email",label:"Contact Email",placeholder:"e.g. manager@phe.co.id",description:"Official contact email for the facility"})}),e.jsx(t.Col,{span:{base:12,sm:6},children:e.jsx(o,{name:"contact_phone",label:"Contact Phone",placeholder:"e.g. +62 812 3456 7890",description:"Phone number for facility contact"})})]})})]})}function oe({onSubmit:a}){const{mutate:l,isPending:m}=te(),i=P({mode:"controlled",validate:I(u)}),r=S(),{fileIds:b,updateFilesMetadata:n}=r,x=i.onSubmit(g=>{l({variables:g},{onError:f=>_(i,f),onSuccess:()=>{a(),n()}})});return e.jsx(M,{form:i,onSubmit:x,children:e.jsx(w,{fileIdManager:r,children:e.jsxs(p,{children:[e.jsx(k,{}),e.jsx(y,{justify:"flex-end",children:e.jsx(v,{onClick:()=>console.log(i.errors),type:"submit",loading:m,mt:"md",leftSection:e.jsx(ie,{size:16,stroke:5}),children:"Add"})})]})})})}function re({onSubmit:a,id:l}){const{mutate:m,isPending:i}=se({route:{id:l}}),{data:r,isLoading:b}=z({route:{id:l}}),n=P({mode:"controlled",validate:I(u)});G.useEffect(()=>{r&&n.setValues(r)},[r]);const x=S(),{fileIds:g,updateFilesMetadata:f}=x,E=n.onSubmit(L=>{m({variables:L},{onError:B=>_(n,B),onSuccess:()=>{a(),f()}})});return b?e.jsx(F,{color:"blue",size:"xl"}):e.jsx(M,{form:n,onSubmit:E,children:e.jsx(w,{fileIdManager:x,children:e.jsxs(p,{children:[e.jsx(k,{}),e.jsx(y,{justify:"flex-end",children:e.jsx(v,{type:"submit",onClick:()=>console.log(n.errors),loading:i,mt:"md",leftSection:e.jsx(ae,{size:16,stroke:2}),children:"Save"})})]})})})}function Ce(a){h.open({title:"Add new facility",children:e.jsx(oe,{onSubmit:()=>{a(),h.closeAll()}}),size:"75rem",zIndex:2e3,withCloseButton:!1})}function Fe(a,l){h.open({title:"Edit facility",children:e.jsx(re,{id:a,onSubmit:()=>{l(),h.closeAll()}}),size:"75rem",zIndex:2e3,withCloseButton:!1})}function ve(a){h.open({title:"View facility",children:e.jsx(le,{id:a}),size:"75rem",zIndex:2e3,withCloseButton:!1})}export{ge as a,ve as b,Fe as c,Ce as o,be as u};
