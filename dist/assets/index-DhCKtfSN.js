import{ab as M,ac as N,r as E,m as p,j as e,S as R,ad as c,ae as S,Q as k,e as C,d as w,af as z,k as O,T as m,X as F,p as v,i as H}from"./index--ClWZahu.js";import{P as L}from"./page-CknD4dKm.js";import{P as G}from"./page-header-BWjuV_E8.js";import{D as i,A as q}from"./index-DqV8S-Pt.js";import{u as _,a as Q,b as Y,c as B}from"./employees-CTMYvjS9.js";import{F as g,G as s,T as U}from"./form-section-C5VgLGpa.js";import{e as J}from"./object-4sH1WIyZ.js";import{u as K,z as V}from"./use-form-L8LbUW_M.js";import{S as I}from"./Select-UMZ64bLE.js";import{D as W}from"./DatePickerInput-BeLOAKO0.js";import"./Title-Ci985OzB.js";import"./Anchor-DIBe1ZWb.js";import"./index-Bn0zxFJ3.js";const X=[{value:"HSE",label:"HSE"},{value:"Finance",label:"Finance"},{value:"Operation",label:"Operation"},{value:"IT",label:"IT"},{value:"Engineering",label:"Engineering"},{value:"Procurement",label:"Procurement"},{value:"HR",label:"HR"},{value:"Maintenance",label:"Maintenance"},{value:"QA/QC",label:"QA/QC"},{value:"Safety",label:"Safety"},{value:"Other",label:"Other"}];function D({employeeId:o,onSuccess:r}){const l=!!o,{data:u}=_(),n=u==null?void 0:u.find(d=>d.id===o),{mutate:y,isPending:h}=Q(),{mutate:x,isPending:b}=Y(),a=K({validate:V(l?M:N)});E.useEffect(()=>{n&&l&&a.setValues({name:n.name,username:n.username,employee_num:n.employee_num,email:n.email,nik:n.nik,position:n.position,department:n.department,phone_number:n.phone_number,hire_date:n.hire_date?new Date(n.hire_date):null,address:n.address,emergency_contact_name:n.emergency_contact_name,emergency_contact_phone:n.emergency_contact_phone,password:"",role:n.role})},[n,l]);const j=a.onSubmit(d=>{l&&o?x({id:o,data:J(d)},{onSuccess:()=>{p.close("employee-edit"),r==null||r()}}):y(d,{onSuccess:()=>{p.close("employee-create"),r==null||r()}})});return e.jsx("form",{onSubmit:j,children:e.jsxs(R,{gap:"md",children:[e.jsx(g,{title:"Basic Information",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Full Name",placeholder:"e.g. John Doe",description:"Employee's full name",required:!l,...a.getInputProps("name")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Username",placeholder:"e.g. johndoe",description:"Used for login",required:!l,...a.getInputProps("username")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Employee Number",placeholder:"e.g. EMP-001",description:"Unique employee identifier",...a.getInputProps("employee_num")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"NIK (National ID)",placeholder:"e.g. 1234567890123456",description:"Indonesian National ID number",...a.getInputProps("nik")})})]})}),e.jsx(g,{title:"Contact Information",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Email Address",placeholder:"e.g. john.doe@company.com",type:"email",description:"Work email address",...a.getInputProps("email")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Phone Number",placeholder:"e.g. +62 812-3456-7890",type:"tel",description:"Mobile or work phone",...a.getInputProps("phone_number")})}),e.jsx(s.Col,{span:12,children:e.jsx(U,{label:"Address",placeholder:"Enter full address",description:"Residential address",minRows:2,...a.getInputProps("address")})})]})}),e.jsx(g,{title:"Employment Information",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Position / Job Title",placeholder:"e.g. Senior Engineer, Manager",description:"Current job position",...a.getInputProps("position")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(I,{label:"Department",placeholder:"Select department",description:"Employee's department",data:X,searchable:!0,clearable:!0,...a.getInputProps("department"),comboboxProps:{zIndex:2001}})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(W,{label:"Hire Date",placeholder:"Select hire date",description:"Date employee was hired",valueFormat:"DD/MM/YYYY",clearable:!0,...a.getInputProps("hire_date"),popoverProps:{zIndex:2001}})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(I,{label:"Role",placeholder:"Select role",description:"System access level",required:!0,data:[{value:"EMPLOYEE",label:"Employee"},{value:"MANAGER",label:"Manager"}],...a.getInputProps("role"),comboboxProps:{zIndex:2001}})})]})}),e.jsx(g,{title:"Emergency Contact",children:e.jsxs(s,{children:[e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Emergency Contact Name",placeholder:"e.g. Jane Doe (Spouse)",description:"Name of person to contact in emergency",...a.getInputProps("emergency_contact_name")})}),e.jsx(s.Col,{span:{base:12,sm:6},children:e.jsx(c,{label:"Emergency Contact Phone",placeholder:"e.g. +62 812-9876-5432",type:"tel",description:"Emergency contact's phone number",...a.getInputProps("emergency_contact_phone")})})]})}),e.jsx(g,{title:"Credentials",children:e.jsx(s,{children:e.jsx(s.Col,{span:12,children:e.jsx(S,{label:"Password",placeholder:l?"Leave blank to keep current password":"Enter password",description:l?"Only enter if you want to change the password":"Password for login access",required:!l,...a.getInputProps("password")})})})}),e.jsxs(k,{justify:"flex-end",mt:"md",children:[e.jsx(C,{variant:"subtle",onClick:()=>p.close(l?"employee-edit":"employee-create"),children:"Cancel"}),e.jsxs(C,{type:"submit",loading:h||b,children:[l?"Update":"Create"," Employee"]})]})]})})}function Z(o){p.open({modalId:"employee-create",title:"Create Employee",size:"lg",children:e.jsx(D,{onSuccess:o})})}function $(o,r){p.open({modalId:"employee-edit",title:"Edit Employee",size:"lg",children:e.jsx(D,{employeeId:o,onSuccess:r})})}function ee(){const{user:o}=w(),r=z(),{page:l,limit:u,setLimit:n,setPage:y}=O(),h=(o==null?void 0:o.role)==="MANAGER",{filters:x,sort:b}=i.useDataTable({sortConfig:{direction:"asc",column:"name"}}),{data:a,isLoading:j,refetch:d}=_(),{mutate:P}=B(),f=E.useCallback(t=>{p.openConfirmModal({title:"Delete Employee",children:"Are you sure you want to delete this employee?",confirmProps:{color:"red"},labels:{confirm:"Delete",cancel:"Cancel"},onConfirm:()=>{P({route:{id:t}}),d()}})},[P,d]),T=E.useMemo(()=>[{accessor:"name",title:"Name",sortable:!0},{accessor:"username",title:"Username",sortable:!0},{accessor:"employee_num",title:"Employee #",render:({employee_num:t})=>t||e.jsx(m,{c:"dimmed",children:"-"})},{accessor:"email",title:"Email",render:({email:t})=>t||e.jsx(m,{c:"dimmed",children:"-"})},{accessor:"nik",title:"NIK",render:({nik:t})=>t||e.jsx(m,{c:"dimmed",children:"-"})},{accessor:"position",title:"Position",render:({position:t})=>t||e.jsx(m,{c:"dimmed",children:"-"})},{accessor:"department",title:"Department",render:({department:t})=>t||e.jsx(m,{c:"dimmed",children:"-"})},{accessor:"phone_number",title:"Phone",render:({phone_number:t})=>t||e.jsx(m,{c:"dimmed",children:"-"})},{accessor:"role",title:"Role",sortable:!0,render:({role:t})=>e.jsx(F,{color:t==="MANAGER"?"blue":"gray",children:t})},{accessor:"id",title:"User ID",render:({id:t})=>e.jsxs(m,{size:"xs",children:[t.slice(0,8),"..."]})},{accessor:"actions",title:"Actions",textAlign:"right",width:130,render:t=>e.jsx(i.Actions,{onView:()=>r(v.manager.employeeDetail(t.id)),onEdit:h?()=>$(t.id,d):void 0,onDelete:h&&t.id!==(o==null?void 0:o.id)?()=>f(t.id):void 0})}],[o==null?void 0:o.id,f,r]),A=H.users;return e.jsxs(i.Container,{children:[e.jsx(i.Title,{icon:e.jsx(A,{size:25}),title:"Employees",actions:h?e.jsx(q,{variant:"default",size:"xs",onClick:()=>Z(d),children:"Add Employee"}):void 0}),e.jsx(i.Filters,{filters:x.filters,onClear:x.clear}),e.jsx(i.Content,{children:e.jsx(i.Table,{striped:!0,minHeight:240,noRecordsText:i.noRecordsText("employees"),recordsPerPageLabel:i.recordsPerPageLabel("employees"),paginationText:i.paginationText("employees"),page:l,records:a??[],fetching:j,onPageChange:y,recordsPerPage:u,totalRecords:(a==null?void 0:a.length)??0,onRecordsPerPageChange:n,recordsPerPageOptions:[5,15,30],sortStatus:b.status,onSortStatusChange:b.change,columns:T,pinLastColumn:!0,highlightOnHover:!0})})]})}const te=[{label:"Employees",href:v.manager.employees},{label:"List"}];function ge(){return e.jsxs(L,{title:"Employees",children:[e.jsx(G,{title:"Employee Management",breadcrumbs:te}),e.jsx(ee,{})]})}export{ge as default};
