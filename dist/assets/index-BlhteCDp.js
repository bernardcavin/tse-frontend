import{at as X,R as b,au as E,ar as Gt,av as Yt,aw as qt,ax as Ur,ay as Vr,az as oe,aA as st,aB as ee,aC as M,aD as Xt,aE as lt,aF as Se,r as D,aG as Zt,aH as Qt,aI as te,aJ as se,aK as Wr,aL as Jt,aM as Gr,aN as he,aO as er,aP as ge,aQ as tr,aR as rr,aS as nr,aT as Yr,aU as De,aV as Lt,aW as ze,aX as ar,aY as ir,aZ as qr,a_ as Et,a$ as Xr,b0 as or,b1 as sr,b2 as Je,b3 as Zr,b4 as Qr,j as i,f as ct,u as ut,l as lr,b5 as dt,a as cr,b6 as ur,v as Jr,g as le,b7 as en,B as dr,b8 as pr,b9 as tn,ba as rn,bb as nn,bc as fr,bd as hr,c as mr,x as It,be as vr,d as pt,S as C,h as an,ah as ke,Q as U,T as $,a8 as on,bf as sn,e as He,a7 as ft,ai as ln,ad as Ze,m as ce,X as ve,aa as cn,k as un,W as Qe,bg as dn,bh as pn,i as fn,p as Ct}from"./index-BVWw_PrA.js";import{P as hn}from"./page-DNX3kEtN.js";import{P as mn}from"./page-header-43JedYbM.js";import{a as vn,I as bn,b as yn,H as gn,c as xn,d as ht,e as An,f as jn,g as _n,u as Pn,h as On}from"./hazard-observations-DfVu0QBc.js";import{c as br}from"./createReactComponent-BSlWaNUk.js";import{I as yr}from"./IconCheck-BsjP39mX.js";import{G as F,D as kn,b as ie}from"./DatePickerInput-DDMfAt3S.js";import{T as Re}from"./Title-DjneduPf.js";import{D as J,A as Sn}from"./index-CAYcvJ-n.js";import{F as N,T as et,S as wn}from"./form-section-D4vue6nD.js";import{u as gr,F as xr,I as Tn,C as Ln}from"./file-upload-X9Z1TClr.js";import{a as En}from"./facilities-eK0t8wSO.js";import{h as mt,F as vt}from"./form-C5ZePmub.js";import{n as In}from"./date-B0_A_nQw.js";import{u as bt,z as yt}from"./use-form-BcjL4Scf.js";import{I as Cn,a as Dn}from"./IconPlus-CDb_akDG.js";import{I as Rn}from"./IconUpload-B2y0t1kj.js";import"./Anchor-CUF9HwxO.js";import"./index-qjmTHeU8.js";import"./IconX-Bmw6WTaL.js";import"./facility-BaOKGZA0.js";var zn=["points","className","baseLinePoints","connectNulls"];function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},xe.apply(this,arguments)}function $n(e,r){if(e==null)return{};var n=Nn(e,r),t,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Nn(e,r){if(e==null)return{};var n={};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(r.indexOf(t)>=0)continue;n[t]=e[t]}return n}function Dt(e){return Hn(e)||Mn(e)||Bn(e)||Fn()}function Fn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bn(e,r){if(e){if(typeof e=="string")return tt(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tt(e,r)}}function Mn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hn(e){if(Array.isArray(e))return tt(e)}function tt(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var Rt=function(r){return r&&r.x===+r.x&&r.y===+r.y},Kn=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return r.forEach(function(t){Rt(t)?n[n.length-1].push(t):n[n.length-1].length>0&&n.push([])}),Rt(r[0])&&n[n.length-1].push(r[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},we=function(r,n){var t=Kn(r);n&&(t=[t.reduce(function(s,o){return[].concat(Dt(s),Dt(o))},[])]);var a=t.map(function(s){return s.reduce(function(o,c,u){return"".concat(o).concat(u===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return t.length===1?"".concat(a,"Z"):a},Un=function(r,n,t){var a=we(r,t);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(we(n.reverse(),t).slice(1))},Vn=function(r){var n=r.points,t=r.className,a=r.baseLinePoints,s=r.connectNulls,o=$n(r,zn);if(!n||!n.length)return null;var c=X("recharts-polygon",t);if(a&&a.length){var u=o.stroke&&o.stroke!=="none",l=Un(n,a,s);return b.createElement("g",{className:c},b.createElement("path",xe({},E(o,!0),{fill:l.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:l})),u?b.createElement("path",xe({},E(o,!0),{fill:"none",d:we(n,s)})):null,u?b.createElement("path",xe({},E(o,!0),{fill:"none",d:we(a,s)})):null)}var f=we(n,s);return b.createElement("path",xe({},E(o,!0),{fill:f.slice(-1)==="Z"?o.fill:"none",className:c,d:f}))},Wn=Yt,Gn=Ur,Yn=qt;function qn(e,r){return e&&e.length?Wn(e,Yn(r),Gn):void 0}var Xn=qn;const Zn=Gt(Xn);var Qn=Yt,Jn=qt,ea=Vr;function ta(e,r){return e&&e.length?Qn(e,Jn(r),ea):void 0}var ra=ta;const na=Gt(ra);var aa=["cx","cy","angle","ticks","axisLine"],ia=["ticks","tick","angle","tickFormatter","stroke"];function je(e){"@babel/helpers - typeof";return je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},je(e)}function Te(){return Te=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},Te.apply(this,arguments)}function zt(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,t)}return n}function pe(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?zt(Object(n),!0).forEach(function(t){Ke(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $t(e,r){if(e==null)return{};var n=oa(e,r),t,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function oa(e,r){if(e==null)return{};var n={};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(r.indexOf(t)>=0)continue;n[t]=e[t]}return n}function sa(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Nt(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,jr(t.key),t)}}function la(e,r,n){return r&&Nt(e.prototype,r),n&&Nt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ca(e,r,n){return r=Ne(r),ua(e,Ar()?Reflect.construct(r,n||[],Ne(e).constructor):r.apply(e,n))}function ua(e,r){if(r&&(je(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return da(e)}function da(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ar=function(){return!!e})()}function Ne(e){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ne(e)}function pa(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&rt(e,r)}function rt(e,r){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},rt(e,r)}function Ke(e,r,n){return r=jr(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function jr(e){var r=fa(e,"string");return je(r)=="symbol"?r:r+""}function fa(e,r){if(je(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var t=n.call(e,r||"default");if(je(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Ue=function(e){function r(){return sa(this,r),ca(this,r,arguments)}return pa(r,e),la(r,[{key:"getTickValueCoord",value:function(t){var a=t.coordinate,s=this.props,o=s.angle,c=s.cx,u=s.cy;return ee(c,u,a,o)}},{key:"getTickTextAnchor",value:function(){var t=this.props.orientation,a;switch(t){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var t=this.props,a=t.cx,s=t.cy,o=t.angle,c=t.ticks,u=Zn(c,function(f){return f.coordinate||0}),l=na(c,function(f){return f.coordinate||0});return{cx:a,cy:s,startAngle:o,endAngle:o,innerRadius:l.coordinate||0,outerRadius:u.coordinate||0}}},{key:"renderAxisLine",value:function(){var t=this.props,a=t.cx,s=t.cy,o=t.angle,c=t.ticks,u=t.axisLine,l=$t(t,aa),f=c.reduce(function(d,p){return[Math.min(d[0],p.coordinate),Math.max(d[1],p.coordinate)]},[1/0,-1/0]),h=ee(a,s,f[0],o),m=ee(a,s,f[1],o),y=pe(pe(pe({},E(l,!1)),{},{fill:"none"},E(u,!1)),{},{x1:h.x,y1:h.y,x2:m.x,y2:m.y});return b.createElement("line",Te({className:"recharts-polar-radius-axis-line"},y))}},{key:"renderTicks",value:function(){var t=this,a=this.props,s=a.ticks,o=a.tick,c=a.angle,u=a.tickFormatter,l=a.stroke,f=$t(a,ia),h=this.getTickTextAnchor(),m=E(f,!1),y=E(o,!1),d=s.map(function(p,x){var j=t.getTickValueCoord(p),g=pe(pe(pe(pe({textAnchor:h,transform:"rotate(".concat(90-c,", ").concat(j.x,", ").concat(j.y,")")},m),{},{stroke:"none",fill:l},y),{},{index:x},j),{},{payload:p});return b.createElement(M,Te({className:X("recharts-polar-radius-axis-tick",Xt(o)),key:"tick-".concat(p.coordinate)},lt(t.props,p,x)),r.renderTickItem(o,g,u?u(p.value,x):p.value))});return b.createElement(M,{className:"recharts-polar-radius-axis-ticks"},d)}},{key:"render",value:function(){var t=this.props,a=t.ticks,s=t.axisLine,o=t.tick;return!a||!a.length?null:b.createElement(M,{className:X("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),o&&this.renderTicks(),Se.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(t,a,s){var o;return b.isValidElement(t)?o=b.cloneElement(t,a):oe(t)?o=t(a):o=b.createElement(st,Te({},a,{className:"recharts-polar-radius-axis-tick-value"}),s),o}}])}(D.PureComponent);Ke(Ue,"displayName","PolarRadiusAxis");Ke(Ue,"axisType","radiusAxis");Ke(Ue,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function _e(e){"@babel/helpers - typeof";return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_e(e)}function me(){return me=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},me.apply(this,arguments)}function Ft(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,t)}return n}function fe(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Ft(Object(n),!0).forEach(function(t){Ve(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ha(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Bt(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,Pr(t.key),t)}}function ma(e,r,n){return r&&Bt(e.prototype,r),n&&Bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function va(e,r,n){return r=Fe(r),ba(e,_r()?Reflect.construct(r,n||[],Fe(e).constructor):r.apply(e,n))}function ba(e,r){if(r&&(_e(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ya(e)}function ya(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_r=function(){return!!e})()}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Fe(e)}function ga(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&nt(e,r)}function nt(e,r){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},nt(e,r)}function Ve(e,r,n){return r=Pr(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Pr(e){var r=xa(e,"string");return _e(r)=="symbol"?r:r+""}function xa(e,r){if(_e(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var t=n.call(e,r||"default");if(_e(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Aa=Math.PI/180,Mt=1e-5,We=function(e){function r(){return ha(this,r),va(this,r,arguments)}return ga(r,e),ma(r,[{key:"getTickLineCoord",value:function(t){var a=this.props,s=a.cx,o=a.cy,c=a.radius,u=a.orientation,l=a.tickSize,f=l||8,h=ee(s,o,c,t.coordinate),m=ee(s,o,c+(u==="inner"?-1:1)*f,t.coordinate);return{x1:h.x,y1:h.y,x2:m.x,y2:m.y}}},{key:"getTickTextAnchor",value:function(t){var a=this.props.orientation,s=Math.cos(-t.coordinate*Aa),o;return s>Mt?o=a==="outer"?"start":"end":s<-Mt?o=a==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var t=this.props,a=t.cx,s=t.cy,o=t.radius,c=t.axisLine,u=t.axisLineType,l=fe(fe({},E(this.props,!1)),{},{fill:"none"},E(c,!1));if(u==="circle")return b.createElement(Zt,me({className:"recharts-polar-angle-axis-line"},l,{cx:a,cy:s,r:o}));var f=this.props.ticks,h=f.map(function(m){return ee(a,s,o,m.coordinate)});return b.createElement(Vn,me({className:"recharts-polar-angle-axis-line"},l,{points:h}))}},{key:"renderTicks",value:function(){var t=this,a=this.props,s=a.ticks,o=a.tick,c=a.tickLine,u=a.tickFormatter,l=a.stroke,f=E(this.props,!1),h=E(o,!1),m=fe(fe({},f),{},{fill:"none"},E(c,!1)),y=s.map(function(d,p){var x=t.getTickLineCoord(d),j=t.getTickTextAnchor(d),g=fe(fe(fe({textAnchor:j},f),{},{stroke:"none",fill:l},h),{},{index:p,payload:d,x:x.x2,y:x.y2});return b.createElement(M,me({className:X("recharts-polar-angle-axis-tick",Xt(o)),key:"tick-".concat(d.coordinate)},lt(t.props,d,p)),c&&b.createElement("line",me({className:"recharts-polar-angle-axis-tick-line"},m,x)),o&&r.renderTickItem(o,g,u?u(d.value,p):d.value))});return b.createElement(M,{className:"recharts-polar-angle-axis-ticks"},y)}},{key:"render",value:function(){var t=this.props,a=t.ticks,s=t.radius,o=t.axisLine;return s<=0||!a||!a.length?null:b.createElement(M,{className:X("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(t,a,s){var o;return b.isValidElement(t)?o=b.cloneElement(t,a):oe(t)?o=t(a):o=b.createElement(st,me({},a,{className:"recharts-polar-angle-axis-tick-value"}),s),o}}])}(D.PureComponent);Ve(We,"displayName","PolarAngleAxis");Ve(We,"axisType","angleAxis");Ve(We,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var $e;function Pe(e){"@babel/helpers - typeof";return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Pe(e)}function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},Ae.apply(this,arguments)}function Ht(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,t)}return n}function w(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Ht(Object(n),!0).forEach(function(t){Y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ja(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Kt(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,kr(t.key),t)}}function _a(e,r,n){return r&&Kt(e.prototype,r),n&&Kt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pa(e,r,n){return r=Be(r),Oa(e,Or()?Reflect.construct(r,n||[],Be(e).constructor):r.apply(e,n))}function Oa(e,r){if(r&&(Pe(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ka(e)}function ka(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Or(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Or=function(){return!!e})()}function Be(e){return Be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Be(e)}function Sa(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&at(e,r)}function at(e,r){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},at(e,r)}function Y(e,r,n){return r=kr(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function kr(e){var r=wa(e,"string");return Pe(r)=="symbol"?r:r+""}function wa(e,r){if(Pe(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var t=n.call(e,r||"default");if(Pe(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var re=function(e){function r(n){var t;return ja(this,r),t=Pa(this,r,[n]),Y(t,"pieRef",null),Y(t,"sectorRefs",[]),Y(t,"id",ar("recharts-pie-")),Y(t,"handleAnimationEnd",function(){var a=t.props.onAnimationEnd;t.setState({isAnimationFinished:!0}),oe(a)&&a()}),Y(t,"handleAnimationStart",function(){var a=t.props.onAnimationStart;t.setState({isAnimationFinished:!1}),oe(a)&&a()}),t.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},t}return Sa(r,e),_a(r,[{key:"isActiveIndex",value:function(t){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(t)!==-1:t===a}},{key:"hasActiveIndex",value:function(){var t=this.props.activeIndex;return Array.isArray(t)?t.length!==0:t||t===0}},{key:"renderLabels",value:function(t){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.label,c=s.labelLine,u=s.dataKey,l=s.valueKey,f=E(this.props,!1),h=E(o,!1),m=E(c,!1),y=o&&o.offsetRadius||20,d=t.map(function(p,x){var j=(p.startAngle+p.endAngle)/2,g=ee(p.cx,p.cy,p.outerRadius+y,j),_=w(w(w(w({},f),p),{},{stroke:"none"},h),{},{index:x,textAnchor:r.getTextAnchor(g.x,p.cx)},g),v=w(w(w(w({},f),p),{},{fill:"none",stroke:p.fill},m),{},{index:x,points:[ee(p.cx,p.cy,p.outerRadius,j),g]}),A=u;return te(u)&&te(l)?A="value":te(u)&&(A=l),b.createElement(M,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(x)},c&&r.renderLabelLineItem(c,v,"line"),r.renderLabelItem(o,_,se(p,A)))});return b.createElement(M,{className:"recharts-pie-labels"},d)}},{key:"renderSectorsStatically",value:function(t){var a=this,s=this.props,o=s.activeShape,c=s.blendStroke,u=s.inactiveShape;return t.map(function(l,f){if((l==null?void 0:l.startAngle)===0&&(l==null?void 0:l.endAngle)===0&&t.length!==1)return null;var h=a.isActiveIndex(f),m=u&&a.hasActiveIndex()?u:null,y=h?o:m,d=w(w({},l),{},{stroke:c?l.fill:l.stroke,tabIndex:-1});return b.createElement(M,Ae({ref:function(x){x&&!a.sectorRefs.includes(x)&&a.sectorRefs.push(x)},tabIndex:-1,className:"recharts-pie-sector"},lt(a.props,l,f),{key:"sector-".concat(l==null?void 0:l.startAngle,"-").concat(l==null?void 0:l.endAngle,"-").concat(l.midAngle,"-").concat(f)}),b.createElement(Wr,Ae({option:y,isActive:h,shapeType:"sector"},d)))})}},{key:"renderSectorsWithAnimation",value:function(){var t=this,a=this.props,s=a.sectors,o=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,l=a.animationEasing,f=a.animationId,h=this.state,m=h.prevSectors,y=h.prevIsAnimationActive;return b.createElement(Jt,{begin:c,duration:u,isActive:o,easing:l,from:{t:0},to:{t:1},key:"pie-".concat(f,"-").concat(y),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(d){var p=d.t,x=[],j=s&&s[0],g=j.startAngle;return s.forEach(function(_,v){var A=m&&m[v],P=v>0?Gr(_,"paddingAngle",0):0;if(A){var k=he(A.endAngle-A.startAngle,_.endAngle-_.startAngle),O=w(w({},_),{},{startAngle:g+P,endAngle:g+k(p)+P});x.push(O),g=O.endAngle}else{var I=_.endAngle,L=_.startAngle,B=he(0,I-L),T=B(p),R=w(w({},_),{},{startAngle:g+P,endAngle:g+T+P});x.push(R),g=R.endAngle}}),b.createElement(M,null,t.renderSectorsStatically(x))})}},{key:"attachKeyboardHandlers",value:function(t){var a=this;t.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var o=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"ArrowRight":{var c=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[c].focus(),a.setState({sectorToFocus:c});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var t=this.props,a=t.sectors,s=t.isAnimationActive,o=this.state.prevSectors;return s&&a&&a.length&&(!o||!er(o,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var t=this,a=this.props,s=a.hide,o=a.sectors,c=a.className,u=a.label,l=a.cx,f=a.cy,h=a.innerRadius,m=a.outerRadius,y=a.isAnimationActive,d=this.state.isAnimationFinished;if(s||!o||!o.length||!ge(l)||!ge(f)||!ge(h)||!ge(m))return null;var p=X("recharts-pie",c);return b.createElement(M,{tabIndex:this.props.rootTabIndex,className:p,ref:function(j){t.pieRef=j}},this.renderSectors(),u&&this.renderLabels(o),Se.renderCallByParent(this.props,null,!1),(!y||d)&&tr.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(t,a){return a.prevIsAnimationActive!==t.isAnimationActive?{prevIsAnimationActive:t.isAnimationActive,prevAnimationId:t.animationId,curSectors:t.sectors,prevSectors:[],isAnimationFinished:!0}:t.isAnimationActive&&t.animationId!==a.prevAnimationId?{prevAnimationId:t.animationId,curSectors:t.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:t.sectors!==a.curSectors?{curSectors:t.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(t,a){return t>a?"start":t<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(t,a,s){if(b.isValidElement(t))return b.cloneElement(t,a);if(oe(t))return t(a);var o=X("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return b.createElement(Qt,Ae({},a,{key:s,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(t,a,s){if(b.isValidElement(t))return b.cloneElement(t,a);var o=s;if(oe(t)&&(o=t(a),b.isValidElement(o)))return o;var c=X("recharts-pie-label-text",typeof t!="boolean"&&!oe(t)?t.className:"");return b.createElement(st,Ae({},a,{alignmentBaseline:"middle",className:c}),o)}}])}(D.PureComponent);$e=re;Y(re,"displayName","Pie");Y(re,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!rr.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Y(re,"parseDeltaAngle",function(e,r){var n=ze(r-e),t=Math.min(Math.abs(r-e),360);return n*t});Y(re,"getRealPieData",function(e){var r=e.data,n=e.children,t=E(e,!1),a=nr(n,ir);return r&&r.length?r.map(function(s,o){return w(w(w({payload:s},t),s),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(s){return w(w({},t),s.props)}):[]});Y(re,"parseCoordinateOfPie",function(e,r){var n=r.top,t=r.left,a=r.width,s=r.height,o=Yr(a,s),c=t+De(e.cx,a,a/2),u=n+De(e.cy,s,s/2),l=De(e.innerRadius,o,0),f=De(e.outerRadius,o,o*.8),h=e.maxRadius||Math.sqrt(a*a+s*s)/2;return{cx:c,cy:u,innerRadius:l,outerRadius:f,maxRadius:h}});Y(re,"getComposedData",function(e){var r=e.item,n=e.offset,t=r.type.defaultProps!==void 0?w(w({},r.type.defaultProps),r.props):r.props,a=$e.getRealPieData(t);if(!a||!a.length)return null;var s=t.cornerRadius,o=t.startAngle,c=t.endAngle,u=t.paddingAngle,l=t.dataKey,f=t.nameKey,h=t.valueKey,m=t.tooltipType,y=Math.abs(t.minAngle),d=$e.parseCoordinateOfPie(t,n),p=$e.parseDeltaAngle(o,c),x=Math.abs(p),j=l;te(l)&&te(h)?(Lt(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),j="value"):te(l)&&(Lt(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),j=h);var g=a.filter(function(O){return se(O,j,0)!==0}).length,_=(x>=360?g:g-1)*u,v=x-g*y-_,A=a.reduce(function(O,I){var L=se(I,j,0);return O+(ge(L)?L:0)},0),P;if(A>0){var k;P=a.map(function(O,I){var L=se(O,j,0),B=se(O,f,I),T=(ge(L)?L:0)/A,R;I?R=k.endAngle+ze(p)*u*(L!==0?1:0):R=o;var V=R+ze(p)*((L!==0?y:0)+T*v),W=(R+V)/2,H=(d.innerRadius+d.outerRadius)/2,ue=[{name:B,value:L,payload:O,dataKey:j,type:m}],G=ee(d.cx,d.cy,H,W);return k=w(w(w({percent:T,cornerRadius:s,name:B,tooltipPayload:ue,midAngle:W,middleRadius:H,tooltipPosition:G},O),d),{},{value:se(O,j),startAngle:R,endAngle:V,payload:O,paddingAngle:ze(p)*u}),k})}return w(w({},d),{},{sectors:P,data:a})});var Ta=["type","layout","connectNulls","ref"],La=["key"];function Oe(e){"@babel/helpers - typeof";return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Oe(e)}function Ut(e,r){if(e==null)return{};var n=Ea(e,r),t,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Ea(e,r){if(e==null)return{};var n={};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(r.indexOf(t)>=0)continue;n[t]=e[t]}return n}function Le(){return Le=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},Le.apply(this,arguments)}function Vt(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,t)}return n}function K(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Vt(Object(n),!0).forEach(function(t){q(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ye(e){return Ra(e)||Da(e)||Ca(e)||Ia()}function Ia(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ca(e,r){if(e){if(typeof e=="string")return it(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,r)}}function Da(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ra(e){if(Array.isArray(e))return it(e)}function it(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function za(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Wt(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,wr(t.key),t)}}function $a(e,r,n){return r&&Wt(e.prototype,r),n&&Wt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Na(e,r,n){return r=Me(r),Fa(e,Sr()?Reflect.construct(r,n||[],Me(e).constructor):r.apply(e,n))}function Fa(e,r){if(r&&(Oe(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ba(e)}function Ba(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sr=function(){return!!e})()}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Me(e)}function Ma(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&ot(e,r)}function ot(e,r){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},ot(e,r)}function q(e,r,n){return r=wr(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function wr(e){var r=Ha(e,"string");return Oe(r)=="symbol"?r:r+""}function Ha(e,r){if(Oe(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var t=n.call(e,r||"default");if(Oe(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Ee=function(e){function r(){var n;za(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=Na(this,r,[].concat(a)),q(n,"state",{isAnimationFinished:!0,totalLength:0}),q(n,"generateSimpleStrokeDasharray",function(o,c){return"".concat(c,"px ").concat(o-c,"px")}),q(n,"getStrokeDasharray",function(o,c,u){var l=u.reduce(function(j,g){return j+g});if(!l)return n.generateSimpleStrokeDasharray(c,o);for(var f=Math.floor(o/l),h=o%l,m=c-o,y=[],d=0,p=0;d<u.length;p+=u[d],++d)if(p+u[d]>h){y=[].concat(ye(u.slice(0,d)),[h-p]);break}var x=y.length%2===0?[0,m]:[m];return[].concat(ye(r.repeat(u,f)),ye(y),x).map(function(j){return"".concat(j,"px")}).join(", ")}),q(n,"id",ar("recharts-line-")),q(n,"pathRef",function(o){n.mainCurve=o}),q(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),q(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Ma(r,e),$a(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var t=this.getTotalLength();this.setState({totalLength:t})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var t=this.getTotalLength();t!==this.state.totalLength&&this.setState({totalLength:t})}}},{key:"getTotalLength",value:function(){var t=this.mainCurve;try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(t,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.points,c=s.xAxis,u=s.yAxis,l=s.layout,f=s.children,h=nr(f,Xr);if(!h)return null;var m=function(p,x){return{x:p.x,y:p.y,value:p.value,errorVal:se(p.payload,x)}},y={clipPath:t?"url(#clipPath-".concat(a,")"):null};return b.createElement(M,y,h.map(function(d){return b.cloneElement(d,{key:"bar-".concat(d.props.dataKey),data:o,xAxis:c,yAxis:u,layout:l,dataPointFormatter:m})}))}},{key:"renderDots",value:function(t,a,s){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,u=c.dot,l=c.points,f=c.dataKey,h=E(this.props,!1),m=E(u,!0),y=l.map(function(p,x){var j=K(K(K({key:"dot-".concat(x),r:3},h),m),{},{value:p.value,dataKey:f,cx:p.x,cy:p.y,index:x,payload:p.payload});return r.renderDotItem(u,j)}),d={clipPath:t?"url(#clipPath-".concat(a?"":"dots-").concat(s,")"):null};return b.createElement(M,Le({className:"recharts-line-dots",key:"dots"},d),y)}},{key:"renderCurveStatically",value:function(t,a,s,o){var c=this.props,u=c.type,l=c.layout,f=c.connectNulls;c.ref;var h=Ut(c,Ta),m=K(K(K({},E(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(s,")"):null,points:t},o),{},{type:u,layout:l,connectNulls:f});return b.createElement(Qt,Le({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(t,a){var s=this,o=this.props,c=o.points,u=o.strokeDasharray,l=o.isAnimationActive,f=o.animationBegin,h=o.animationDuration,m=o.animationEasing,y=o.animationId,d=o.animateNewValues,p=o.width,x=o.height,j=this.state,g=j.prevPoints,_=j.totalLength;return b.createElement(Jt,{begin:f,duration:h,isActive:l,easing:m,from:{t:0},to:{t:1},key:"line-".concat(y),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(v){var A=v.t;if(g){var P=g.length/c.length,k=c.map(function(T,R){var V=Math.floor(R*P);if(g[V]){var W=g[V],H=he(W.x,T.x),ue=he(W.y,T.y);return K(K({},T),{},{x:H(A),y:ue(A)})}if(d){var G=he(p*2,T.x),ne=he(x/2,T.y);return K(K({},T),{},{x:G(A),y:ne(A)})}return K(K({},T),{},{x:T.x,y:T.y})});return s.renderCurveStatically(k,t,a)}var O=he(0,_),I=O(A),L;if(u){var B="".concat(u).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});L=s.getStrokeDasharray(I,_,B)}else L=s.generateSimpleStrokeDasharray(_,I);return s.renderCurveStatically(c,t,a,{strokeDasharray:L})})}},{key:"renderCurve",value:function(t,a){var s=this.props,o=s.points,c=s.isAnimationActive,u=this.state,l=u.prevPoints,f=u.totalLength;return c&&o&&o.length&&(!l&&f>0||!er(l,o))?this.renderCurveWithAnimation(t,a):this.renderCurveStatically(o,t,a)}},{key:"render",value:function(){var t,a=this.props,s=a.hide,o=a.dot,c=a.points,u=a.className,l=a.xAxis,f=a.yAxis,h=a.top,m=a.left,y=a.width,d=a.height,p=a.isAnimationActive,x=a.id;if(s||!c||!c.length)return null;var j=this.state.isAnimationFinished,g=c.length===1,_=X("recharts-line",u),v=l&&l.allowDataOverflow,A=f&&f.allowDataOverflow,P=v||A,k=te(x)?this.id:x,O=(t=E(o,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},I=O.r,L=I===void 0?3:I,B=O.strokeWidth,T=B===void 0?2:B,R=qr(o)?o:{},V=R.clipDot,W=V===void 0?!0:V,H=L*2+T;return b.createElement(M,{className:_},v||A?b.createElement("defs",null,b.createElement("clipPath",{id:"clipPath-".concat(k)},b.createElement("rect",{x:v?m:m-y/2,y:A?h:h-d/2,width:v?y:y*2,height:A?d:d*2})),!W&&b.createElement("clipPath",{id:"clipPath-dots-".concat(k)},b.createElement("rect",{x:m-H/2,y:h-H/2,width:y+H,height:d+H}))):null,!g&&this.renderCurve(P,k),this.renderErrorBar(P,k),(g||o)&&this.renderDots(P,W,k),(!p||j)&&tr.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(t,a){return t.animationId!==a.prevAnimationId?{prevAnimationId:t.animationId,curPoints:t.points,prevPoints:a.curPoints}:t.points!==a.curPoints?{curPoints:t.points}:null}},{key:"repeat",value:function(t,a){for(var s=t.length%2!==0?[].concat(ye(t),[0]):t,o=[],c=0;c<a;++c)o=[].concat(ye(o),ye(s));return o}},{key:"renderDotItem",value:function(t,a){var s;if(b.isValidElement(t))s=b.cloneElement(t,a);else if(oe(t))s=t(a);else{var o=a.key,c=Ut(a,La),u=X("recharts-line-dot",typeof t!="boolean"?t.className:"");s=b.createElement(Zt,Le({key:o},c,{className:u}))}return s}}])}(D.PureComponent);q(Ee,"displayName","Line");q(Ee,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!rr.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});q(Ee,"getComposedData",function(e){var r=e.props,n=e.xAxis,t=e.yAxis,a=e.xAxisTicks,s=e.yAxisTicks,o=e.dataKey,c=e.bandSize,u=e.displayedData,l=e.offset,f=r.layout,h=u.map(function(m,y){var d=se(m,o);return f==="horizontal"?{x:Et({axis:n,ticks:a,bandSize:c,entry:m,index:y}),y:te(d)?null:t.scale(d),value:d,payload:m}:{x:te(d)?null:n.scale(d),y:Et({axis:t,ticks:s,bandSize:c,entry:m,index:y}),value:d,payload:m}});return K({points:h,layout:f},l)});var Ka=or({chartName:"LineChart",GraphicalChild:Ee,axisComponents:[{axisType:"xAxis",AxisComp:sr},{axisType:"yAxis",AxisComp:Je}],formatAxisMap:Zr}),Ua=or({chartName:"PieChart",GraphicalChild:re,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:We},{axisType:"radiusAxis",AxisComp:Ue}],formatAxisMap:Qr,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function Va({x:e,y:r,value:n,valueFormatter:t}){return i.jsx("g",{transform:`translate(${e},${r})`,children:i.jsx("text",{x:0,y:0,dy:-8,dx:-10,textAnchor:"top",fill:"var(--chart-text-color, var(--mantine-color-dimmed))",fontSize:8,children:t?t(n):n})})}const Wa={withXAxis:!0,withYAxis:!0,withTooltip:!0,tooltipAnimationDuration:0,fillOpacity:1,tickLine:"y",strokeDasharray:"5 5",gridAxis:"x",withDots:!0,connectNulls:!0,strokeWidth:2,curveType:"monotone",gradientStops:[{offset:0,color:"red"},{offset:100,color:"blue"}]},Ga=mr((e,{textColor:r,gridColor:n})=>({root:{"--chart-text-color":r?le(r,e):void 0,"--chart-grid-color":n?le(n,e):void 0}})),gt=ct((e,r)=>{const n=ut("LineChart",Wa,e),{classNames:t,className:a,style:s,styles:o,unstyled:c,vars:u,data:l,withLegend:f,legendProps:h,series:m,onMouseLeave:y,dataKey:d,withTooltip:p,withXAxis:x,withYAxis:j,gridAxis:g,tickLine:_,xAxisProps:v,yAxisProps:A,unit:P,tooltipAnimationDuration:k,strokeDasharray:O,gridProps:I,tooltipProps:L,referenceLines:B,withDots:T,dotProps:R,activeDotProps:V,strokeWidth:W,lineChartProps:H,connectNulls:ue,fillOpacity:G,curveType:ne,orientation:be,dir:Er,valueFormatter:Ie,children:Ir,lineProps:Ge,xAxisLabel:Ye,yAxisLabel:Ce,type:ae,gradientStops:qe,withRightYAxis:Cr,rightYAxisLabel:_t,rightYAxisProps:Dr,withPointLabels:Rr,...zr}=n,Xe=lr(),$r=g!=="none"&&(_==="x"||_==="xy"),Nr=g!=="none"&&(_==="y"||_==="xy"),[Pt,Ot]=D.useState(null),Fr=Pt!==null,Br=S=>{Ot(null),y==null||y(S)},{resolvedClassNames:kt,resolvedStyles:St}=dt({classNames:t,styles:o,props:n}),Z=cr({name:"LineChart",classes:ur,props:n,className:a,style:s,classNames:t,styles:o,unstyled:c,vars:u,varsResolver:Ga}),wt=`line-chart-gradient-${Jr()}`,Mr=qe==null?void 0:qe.map(S=>i.jsx("stop",{offset:`${S.offset}%`,stopColor:le(S.color,Xe)},S.color)),Hr=m.map(S=>{const Q=le(S.color,Xe),de=Fr&&Pt!==S.name;return D.createElement(Ee,{...Z("line"),key:S.name,name:S.name,dataKey:S.name,dot:T?{fillOpacity:de?0:1,strokeOpacity:de?0:1,strokeWidth:1,fill:ae==="gradient"?"var(--mantine-color-gray-7)":Q,stroke:ae==="gradient"?"white":Q,...R}:!1,activeDot:T?{fill:ae==="gradient"?"var(--mantine-color-gray-7)":Q,stroke:ae==="gradient"?"white":Q,...V}:!1,fill:Q,stroke:ae==="gradient"?`url(#${wt})`:Q,strokeWidth:W,isAnimationActive:!1,fillOpacity:de?0:G,strokeOpacity:de?.5:G,connectNulls:ue,type:ne,strokeDasharray:S.strokeDasharray,yAxisId:S.yAxisId||"left",label:Rr?i.jsx(Va,{valueFormatter:Ie}):void 0,...typeof Ge=="function"?Ge(S):Ge})}),Kr=B==null?void 0:B.map((S,Q)=>{const de=le(S.color,Xe);return i.jsx(en,{stroke:S.color?de:"var(--chart-grid-color)",strokeWidth:1,yAxisId:S.yAxisId||"left",...S,label:{value:S.label,fill:S.color?de:"currentColor",fontSize:12,position:S.labelPosition??"insideBottomLeft"},...Z("referenceLine")},Q)}),Tt={axisLine:!1,...be==="vertical"?{dataKey:d,type:"category"}:{type:"number"},tickLine:Nr?{stroke:"currentColor"}:!1,allowDecimals:!0,unit:P,tickFormatter:be==="vertical"?void 0:Ie,...Z("axis")};return i.jsx(dr,{ref:r,...Z("root"),onMouseLeave:Br,dir:Er||"ltr",...zr,children:i.jsx(pr,{...Z("container"),children:i.jsxs(Ka,{data:l,layout:be,margin:{bottom:Ye?30:void 0,left:Ce?10:void 0,right:Ce?5:void 0},...H,children:[ae==="gradient"&&i.jsx("defs",{children:i.jsx("linearGradient",{id:wt,x1:"0",y1:"0",x2:"0",y2:"1",children:Mr})}),f&&i.jsx(tn,{verticalAlign:"top",content:S=>i.jsx(rn,{payload:S.payload,onHighlight:Ot,legendPosition:(h==null?void 0:h.verticalAlign)||"top",classNames:kt,styles:St,series:m,showColor:ae!=="gradient"}),...h}),i.jsxs(sr,{hide:!x,...be==="vertical"?{type:"number"}:{dataKey:d},tick:{transform:"translate(0, 10)",fontSize:12,fill:"currentColor"},stroke:"",interval:"preserveStartEnd",tickLine:$r?{stroke:"currentColor"}:!1,minTickGap:5,tickFormatter:be==="vertical"?Ie:void 0,...Z("axis"),...v,children:[Ye&&i.jsx(Se,{position:"insideBottom",offset:-20,fontSize:12,...Z("axisLabel"),children:Ye}),v==null?void 0:v.children]}),i.jsxs(Je,{yAxisId:"left",orientation:"left",tick:{transform:"translate(-10, 0)",fontSize:12,fill:"currentColor"},hide:!j,...Tt,...A,children:[Ce&&i.jsx(Se,{position:"insideLeft",angle:-90,textAnchor:"middle",fontSize:12,offset:-5,...Z("axisLabel"),children:Ce}),A==null?void 0:A.children]}),i.jsxs(Je,{yAxisId:"right",orientation:"right",tick:{transform:"translate(10, 0)",fontSize:12,fill:"currentColor"},hide:!Cr,...Tt,...Dr,children:[_t&&i.jsx(Se,{position:"insideRight",angle:90,textAnchor:"middle",fontSize:12,offset:-5,...Z("axisLabel"),children:_t}),A==null?void 0:A.children]}),i.jsx(nn,{strokeDasharray:O,vertical:g==="y"||g==="xy",horizontal:g==="x"||g==="xy",...Z("grid"),...I}),p&&i.jsx(fr,{animationDuration:k,isAnimationActive:k!==0,position:be==="vertical"?{}:{y:0},cursor:{stroke:"var(--chart-grid-color)",strokeWidth:1,strokeDasharray:O},content:({label:S,payload:Q})=>i.jsx(hr,{label:S,payload:Q,unit:P,classNames:kt,styles:St,series:m,valueFormatter:Ie,showColor:ae!=="gradient"}),...L}),Hr,Kr,Ir]})})})});gt.displayName="@mantine/charts/LineChart";gt.classes=ur;var xt={root:"m_cd8943fd"};const Ya={withTooltip:!1,withLabelsLine:!0,paddingAngle:0,size:160,strokeWidth:1,startAngle:0,endAngle:360,tooltipDataSource:"all",labelsPosition:"outside",labelsType:"value"},qa=mr((e,{strokeColor:r,labelColor:n,withLabels:t,size:a,labelsPosition:s})=>({root:{"--chart-stroke-color":r?le(r,e):void 0,"--chart-labels-color":n?le(n,e):void 0,"--chart-size":t&&s==="outside"?It(a+80):It(a)}})),Tr=(e,r,n,t)=>e==="percent"?`${(n*100).toFixed(0)}%`:typeof t=="function"?t(r):r,Xa=(e,r)=>({cx:n,cy:t,midAngle:a,innerRadius:s,outerRadius:o,value:c,percent:u})=>{const l=Math.PI/180,f=s+(o-s)*.5,h=n+f*Math.cos(-a*l),m=t+f*Math.sin(-a*l);return i.jsx("text",{x:h,y:m,textAnchor:h>n?"start":"end",dominantBaseline:"central",className:xt.label,children:Tr(e,c,u,r)})},Za=(e,r)=>({x:n,y:t,cx:a,cy:s,percent:o,value:c})=>i.jsx("text",{x:n,y:t,cx:a,cy:s,textAnchor:n>a?"start":"end",fill:"var(--chart-labels-color, var(--mantine-color-dimmed))",fontFamily:"var(--mantine-font-family)",fontSize:12,children:i.jsx("tspan",{x:n,children:Tr(e,c,o,r)})}),At=ct((e,r)=>{const n=ut("PieChart",Ya,e),{classNames:t,className:a,style:s,styles:o,unstyled:c,vars:u,data:l,withTooltip:f,tooltipAnimationDuration:h,tooltipProps:m,pieProps:y,paddingAngle:d,withLabels:p,withLabelsLine:x,size:j,strokeWidth:g,startAngle:_,endAngle:v,tooltipDataSource:A,children:P,pieChartProps:k,labelsPosition:O,valueFormatter:I,labelsType:L,strokeColor:B,...T}=n,R=lr(),V=cr({name:"PieChart",classes:xt,props:n,className:a,style:s,classNames:t,styles:o,unstyled:c,vars:u,varsResolver:qa}),{resolvedClassNames:W,resolvedStyles:H}=dt({classNames:t,styles:o,props:n}),ue=l.map((G,ne)=>i.jsx(ir,{fill:le(G.color,R),stroke:"var(--chart-stroke-color, var(--mantine-color-body))",strokeWidth:g},ne));return i.jsx(dr,{ref:r,size:j,...V("root"),...T,children:i.jsx(pr,{children:i.jsxs(Ua,{...k,children:[i.jsx(re,{data:l,innerRadius:0,outerRadius:j/2,dataKey:"value",isAnimationActive:!1,paddingAngle:d,startAngle:_,endAngle:v,label:p?O==="inside"?Xa(L||"value",I):Za(L||"value",I):!1,labelLine:x&&O==="outside"?{stroke:"var(--chart-label-color, var(--mantine-color-dimmed))",strokeWidth:1}:!1,...y,children:ue}),f&&i.jsx(fr,{animationDuration:h,isAnimationActive:!1,content:({payload:G})=>{var ne;return i.jsx(hr,{payload:l,classNames:W,styles:H,type:"radial",segmentId:A==="segment"?(ne=G==null?void 0:G[0])==null?void 0:ne.name:void 0,valueFormatter:I})},...m}),P]})})})});At.displayName="@mantine/charts/PieChart";At.classes=xt;/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qa=br("outline","alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.14.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ja=br("outline","clock","IconClock",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 7v5l3 3",key:"svg-1"}]]),ei={input:"m_468e7eda"};const jt=ct((e,r)=>{const n=ut("TimeInput",null,e),{classNames:t,styles:a,unstyled:s,vars:o,withSeconds:c,minTime:u,maxTime:l,value:f,onChange:h,step:m,...y}=n,{resolvedClassNames:d,resolvedStyles:p}=dt({classNames:t,styles:a,props:n}),x=g=>{if(u!==void 0||l!==void 0){const[_,v,A]=g.split(":").map(Number);if(u){const[P,k,O]=u.split(":").map(Number);if(_<P||_===P&&v<k||c&&_===P&&v===k&&A<O)return-1}if(l){const[P,k,O]=l.split(":").map(Number);if(_>P||_===P&&v>k||c&&_===P&&v===k&&A>O)return 1}}return 0},j=g=>{var _,v,A;if((_=n.onBlur)==null||_.call(n,g),u!==void 0||l!==void 0){const P=g.currentTarget.value;if(P){const k=x(P);k===1?(l&&(g.currentTarget.value=l),(v=n.onChange)==null||v.call(n,g)):k===-1&&(u&&(g.currentTarget.value=u),(A=n.onChange)==null||A.call(n,g))}}};return i.jsx(vr,{classNames:{...d,input:X(ei.input,d==null?void 0:d.input)},styles:p,unstyled:s,ref:r,value:f,step:m??(c?1:60),...y,onChange:h,onBlur:j,type:"time",__staticSelector:"TimeInput"})});jt.classes=vr.classes;jt.displayName="@mantine/dates/TimeInput";function ti(){var f,h,m,y;const{user:e}=pt(),{data:r,isLoading:n}=vn();if((e==null?void 0:e.role)!=="MANAGER"&&(e==null?void 0:e.department)!=="HSE"||n||!r)return null;const t=Object.entries(r.status_breakdown||{}).map(([d,p])=>({name:d.replace("_"," ").toUpperCase(),value:p,color:d==="open"?"red.6":d==="in_progress"?"yellow.6":d==="resolved"?"green.6":"gray.6"})).filter(d=>d.value>0),a=Object.entries(r.hazard_types_distribution||{}).map(([d,p])=>({hazard:d.replace("_"," "),count:p})).sort((d,p)=>p.count-d.count).slice(0,6),s=(r.monthly_trend||[]).map(d=>({month:d.month||"N/A",observations:d.count||0})),o=[{title:"Total Observations",value:r.total_observations||0,icon:bn,color:"blue"},{title:"Open",value:((f=r.status_breakdown)==null?void 0:f.open)||0,icon:Qa,color:"red"},{title:"In Progress",value:((h=r.status_breakdown)==null?void 0:h.in_progress)||0,icon:Ja,color:"yellow"},{title:"Resolved",value:((m=r.status_breakdown)==null?void 0:m.resolved)||0,icon:yr,color:"green"}],c=r.total_observations||0,u=((y=r.status_breakdown)==null?void 0:y.resolved)||0,l=c>0?(u/c*100).toFixed(1):"0.0";return i.jsxs(C,{gap:"lg",mb:"lg",children:[i.jsx(an,{cols:{base:1,sm:2,md:4},children:o.map(d=>{const p=d.icon;return i.jsx(ke,{padding:"md",radius:"md",withBorder:!0,children:i.jsxs(U,{justify:"space-between",children:[i.jsxs(C,{gap:0,children:[i.jsx($,{size:"xs",c:"dimmed",fw:500,children:d.title}),i.jsx($,{size:"xl",fw:700,children:d.value})]}),i.jsx(p,{size:32,stroke:1.5,color:`var(--mantine-color-${d.color}-6)`})]})},d.title)})}),i.jsxs(F,{children:[i.jsx(F.Col,{span:{base:12,md:6},children:i.jsx(ke,{padding:"lg",radius:"md",withBorder:!0,h:"100%",children:i.jsxs(C,{gap:"md",children:[i.jsxs(U,{justify:"space-between",children:[i.jsx(Re,{order:4,children:"Status Distribution"}),i.jsxs($,{size:"sm",c:"dimmed",children:["Resolution Rate: ",l,"%"]})]}),i.jsx(on,{children:t.length>0?i.jsx(At,{data:t,withLabelsLine:!0,labelsPosition:"outside",labelsType:"value",withLabels:!0,withTooltip:!0,tooltipDataSource:"segment"}):i.jsx($,{size:"sm",c:"dimmed",ta:"center",py:"xl",children:"No data available"})})]})})}),i.jsx(F.Col,{span:{base:12,md:6},children:i.jsx(ke,{padding:"lg",radius:"md",withBorder:!0,h:"100%",children:i.jsxs(C,{gap:"md",children:[i.jsx(Re,{order:4,children:"Top Hazard Types"}),a.length>0?i.jsx(sn,{h:280,data:a,dataKey:"hazard",series:[{name:"count",color:"blue.6",label:"Count"}],tickLine:"y",gridAxis:"y",withTooltip:!0,withLegend:!0,tooltipAnimationDuration:200,xAxisProps:{angle:-45,textAnchor:"end",height:100}}):i.jsx($,{size:"sm",c:"dimmed",ta:"center",py:"xl",children:"No data available"})]})})}),i.jsx(F.Col,{span:{base:12,md:8},children:i.jsx(ke,{padding:"lg",radius:"md",withBorder:!0,children:i.jsxs(C,{gap:"md",children:[i.jsx(Re,{order:4,children:"Observations Trend (Last 6 Months)"}),s.length>0?i.jsx(gt,{h:300,data:s,dataKey:"month",series:[{name:"observations",color:"blue.6",label:"Observations"}],curveType:"linear",withTooltip:!0,withLegend:!0,tooltipAnimationDuration:200,connectNulls:!0,withDots:!0,gridAxis:"xy"}):i.jsx($,{size:"sm",c:"dimmed",ta:"center",py:"xl",children:"No data available"})]})})}),i.jsx(F.Col,{span:{base:12,md:4},children:i.jsx(ke,{padding:"lg",radius:"md",withBorder:!0,h:"100%",children:i.jsxs(C,{gap:"md",children:[i.jsx(Re,{order:4,children:"Top Facilities"}),i.jsxs(C,{gap:"sm",children:[(r.top_facilities||[]).slice(0,5).map((d,p)=>i.jsxs(U,{justify:"space-between",p:"xs",style:{borderLeft:"3px solid var(--mantine-color-red-6)",backgroundColor:"var(--mantine-color-gray-0)"},children:[i.jsx($,{size:"sm",fw:500,style:{flex:1},truncate:!0,children:d.facility_name||d.facility_id}),i.jsx($,{size:"sm",fw:700,c:"red",children:d.count})]},p)),(!r.top_facilities||r.top_facilities.length===0)&&i.jsx($,{size:"sm",c:"dimmed",ta:"center",children:"No data available"})]})]})})})]})]})}const ri=[{value:"physical",label:"Physical (Fisik)"},{value:"chemical",label:"Chemical (Kimia)"},{value:"biological",label:"Biological (Biologi)"},{value:"ergonomic",label:"Ergonomic (Ergonomi)"},{value:"psychosocial",label:"Psychosocial (Psikososial)"}],ni=[{value:"hit_by_object",label:"Hit by Object (Menabrak/Ditabrak)"},{value:"slip_trip_fall",label:"Slip/Trip/Fall (Terpeleset/Tersandung/Terjatuh)"},{value:"short_circuit_burn",label:"Short Circuit/Burn (Arus Pendek/Terbakar)"},{value:"contact_hazard",label:"Contact Hazard (Kontak Panas/Listrik/Kimia)"},{value:"environmental_pollution",label:"Environmental Pollution (Pencemaran)"},{value:"other",label:"Other (Lain-Lain)"}],ai=[{value:"inadequate_equipment",label:"Inadequate Equipment (Peralatan Tidak Memadai)"},{value:"lack_of_knowledge",label:"Lack of Knowledge (Kurang Pengetahuan)"},{value:"incorrect_ppe_use",label:"Incorrect PPE Use (Penggunaan APD Tidak Tepat)"},{value:"procedure_violation",label:"Procedure Violation (Melanggar Prosedur)"},{value:"no_loto_socialization",label:"No LOTO Socialization (Tidak ada Sosialisasi LOTO)"},{value:"other",label:"Other (Lain-Lain)"}],ii=[{value:"elimination",label:"Elimination (Eliminasi)"},{value:"substitution",label:"Substitution (Substitusi)"},{value:"minimization",label:"Minimization (Minimalisasi)"},{value:"training",label:"Training (Pelatihan)"},{value:"ppe",label:"PPE / APD (Alat Pelindung Diri)"},{value:"other",label:"Other (Lain-Lain)"}];function Lr({form:e}){const{data:r,isLoading:n}=ln({queryKey:["facilityOptions"],queryFn:En}),[t,a]=D.useState(!1),[s,o]=D.useState(!1),[c,u]=D.useState(!1);return D.useEffect(()=>{const l=e.values.potential_risks||[];a(l.includes("other"))},[e.values.potential_risks]),D.useEffect(()=>{const l=e.values.unsafe_reasons||[];o(l.includes("other"))},[e.values.unsafe_reasons]),D.useEffect(()=>{const l=e.values.control_measures||[];u(l.includes("other"))},[e.values.control_measures]),i.jsxs(C,{gap:"md",children:[i.jsx(Tn,{name:"photo_file_ids",title:"Photos",multiple:!0,description:"Upload photos of the hazard observation"}),i.jsx(N,{title:"Observer Information (Informasi Pengamat)",children:i.jsxs(F,{children:[i.jsx(F.Col,{span:{base:12,sm:6},children:i.jsx(wn,{label:"Facility",placeholder:"Select facility",data:r||[],...e.getInputProps("facility_id"),searchable:!0,required:!0,disabled:n,comboboxProps:{zIndex:2001}})}),i.jsx(F.Col,{span:{base:12,sm:3},children:i.jsx(kn,{label:"Observation Date",placeholder:"Select date",...e.getInputProps("observation_date"),valueFormat:"DD/MM/YYYY",required:!0,popoverProps:{zIndex:2001}})}),i.jsx(F.Col,{span:{base:12,sm:3},children:i.jsx(jt,{label:"Observation Time",...e.getInputProps("observation_time"),required:!0})})]})}),i.jsx(N,{title:"Unsafe Action/Condition (Tindakan/Kondisi Tidak Aman)",children:i.jsx(et,{label:"Description",placeholder:"Describe the unsafe action or condition observed...",...e.getInputProps("unsafe_action_condition"),minRows:3,required:!0})}),i.jsx(N,{title:"Hazard Types (Bahaya)",children:i.jsx(ie.Group,{...e.getInputProps("hazard_types"),children:i.jsx(C,{gap:"xs",children:ri.map(l=>i.jsx(ie,{value:l.value,label:l.label},l.value))})})}),i.jsxs(N,{title:"Potential Risks (Resiko Potensial)",children:[i.jsx(ie.Group,{...e.getInputProps("potential_risks"),children:i.jsx(C,{gap:"xs",children:ni.map(l=>i.jsx(ie,{value:l.value,label:l.label},l.value))})}),t&&i.jsx(Ze,{label:"Other Potential Risk Details",placeholder:"Specify other potential risk...",...e.getInputProps("potential_risk_other"),mt:"sm"})]}),i.jsxs(N,{title:"Why Unsafe? (Mengapa Pekerjaan Ini Dilakukan Tidak Aman)",children:[i.jsx(ie.Group,{...e.getInputProps("unsafe_reasons"),children:i.jsx(C,{gap:"xs",children:ai.map(l=>i.jsx(ie,{value:l.value,label:l.label},l.value))})}),s&&i.jsx(Ze,{label:"Other Unsafe Reason Details",placeholder:"Specify other reason...",...e.getInputProps("unsafe_reason_other"),mt:"sm"})]}),i.jsxs(N,{title:"Control Measures (Pengendalian yang Dilakukan)",children:[i.jsx(ie.Group,{...e.getInputProps("control_measures"),children:i.jsx(C,{gap:"xs",children:ii.map(l=>i.jsx(ie,{value:l.value,label:l.label},l.value))})}),c&&i.jsx(Ze,{label:"Other Control Measure Details",placeholder:"Specify other control measure...",...e.getInputProps("control_measure_other"),mt:"sm"})]}),i.jsx(N,{title:"Corrective Action (Tindakan Perbaikan/Saran)",children:i.jsx(et,{label:"Corrective Action or Suggestions",placeholder:"Describe corrective actions taken or suggested...",...e.getInputProps("corrective_action"),minRows:3})})]})}function oi({onSubmit:e}){const{mutate:r,isPending:n}=yn(),t=bt({mode:"controlled",validate:yt(gn),initialValues:{facility_id:"",observation_date:In(new Date),observation_time:new Date().toTimeString().slice(0,5),unsafe_action_condition:"",hazard_types:[],potential_risks:[],potential_risk_other:"",unsafe_reasons:[],unsafe_reason_other:"",control_measures:[],control_measure_other:"",corrective_action:""}}),a=gr(),{updateFilesMetadata:s}=a,o=t.onSubmit(c=>{console.log(c),r(c,{onError:u=>mt(t,u),onSuccess:()=>{e(),s()}})});return i.jsx(vt,{form:t,onSubmit:o,children:i.jsx(xr,{fileIdManager:a,children:i.jsxs(C,{children:[i.jsx(Lr,{form:t}),i.jsx(U,{justify:"flex-end",children:i.jsx(He,{type:"submit",loading:n,mt:"md",leftSection:i.jsx(Cn,{size:16,stroke:5}),children:"Add Observation"})})]})})})}function si({onSubmit:e,id:r}){const{mutate:n,isPending:t}=xn(),{data:a,isLoading:s}=ht(r),o=bt({mode:"controlled",validate:yt(An)});D.useEffect(()=>{a&&o.setValues({...a,observation_date:new Date(a.observation_date)})},[a]);const c=gr(),{updateFilesMetadata:u}=c,l=o.onSubmit(f=>{n({id:r,data:f},{onError:h=>mt(o,h),onSuccess:()=>{e(),u()}})});return s?i.jsx(ft,{color:"blue",size:"xl"}):i.jsx(vt,{form:o,onSubmit:l,children:i.jsx(xr,{fileIdManager:c,children:i.jsxs(C,{children:[i.jsx(Lr,{form:o}),i.jsx(U,{justify:"flex-end",children:i.jsx(He,{type:"submit",loading:t,mt:"md",leftSection:i.jsx(Dn,{size:16,stroke:2}),children:"Save Changes"})})]})})})}function li({onSubmit:e,id:r}){const{mutate:n,isPending:t}=jn(),{data:a,isLoading:s}=ht(r),o=bt({mode:"controlled",validate:yt(_n),initialValues:{resolution_notes:""}}),c=o.onSubmit(u=>{n({id:r,data:u},{onError:l=>mt(o,l),onSuccess:()=>{e()}})});return s?i.jsx(ft,{color:"blue",size:"xl"}):i.jsx(vt,{form:o,onSubmit:c,children:i.jsxs(C,{children:[i.jsxs(N,{title:"Observation Details",children:[i.jsxs($,{size:"sm",children:[i.jsx("strong",{children:"Facility:"})," ",a==null?void 0:a.facility_id]}),i.jsxs($,{size:"sm",children:[i.jsx("strong",{children:"Date:"})," ",a!=null&&a.observation_date?new Date(a.observation_date).toLocaleDateString():"-"]}),i.jsxs($,{size:"sm",children:[i.jsx("strong",{children:"Unsafe Condition:"})," ",a==null?void 0:a.unsafe_action_condition]})]}),i.jsx(N,{title:"Resolution Notes (HSE)",children:i.jsx(et,{name:"resolution_notes",label:"Resolution Notes",placeholder:"Describe how this hazard was resolved...",...o.getInputProps("resolution_notes"),minRows:4,required:!0,description:"Provide detailed information about the resolution actions taken"})}),i.jsx(U,{justify:"flex-end",children:i.jsx(He,{type:"submit",loading:t,color:"green",leftSection:i.jsx(yr,{size:16,stroke:2}),children:"Mark as Resolved"})})]})})}function ci({id:e}){const{data:r,isLoading:n}=ht(e);if(n)return i.jsx(U,{justify:"center",py:"xl",children:i.jsx(ft,{size:"lg"})});if(!r)return i.jsx($,{c:"dimmed",ta:"center",py:"xl",children:"No observation data found."});const t=r;return i.jsxs(C,{gap:"lg",children:[t.photo_file_ids&&t.photo_file_ids.length>0&&i.jsx(N,{title:"Photos",children:i.jsx(Ln,{file_ids:t.photo_file_ids,alt:"Hazard Observation"})}),i.jsx(N,{title:"Observer Information",children:i.jsxs(F,{children:[i.jsxs(F.Col,{span:{base:12,sm:6},children:[i.jsx(z,{label:"Observer",value:t.observer_name||t.observer_id}),i.jsx(z,{label:"Facility",value:t.facility_name||t.facility_id})]}),i.jsxs(F.Col,{span:{base:12,sm:6},children:[i.jsx(z,{label:"Observation Date",value:new Date(t.observation_date).toLocaleDateString()}),i.jsx(z,{label:"Observation Time",value:t.observation_time})]})]})}),i.jsxs(N,{title:"Observation Details",children:[i.jsx(z,{label:"Unsafe Action/Condition",value:t.unsafe_action_condition}),i.jsx(z,{label:"Hazard Types",value:t.hazard_types&&t.hazard_types.length>0?i.jsx(U,{gap:4,children:t.hazard_types.map((a,s)=>i.jsx(ve,{children:a},s))}):"-"}),i.jsx(z,{label:"Potential Risks",value:t.potential_risks&&t.potential_risks.length>0?i.jsx(U,{gap:4,children:t.potential_risks.map((a,s)=>i.jsx(ve,{color:"orange",children:a},s))}):"-"}),t.potential_risk_other&&i.jsx(z,{label:"Other Potential Risk",value:t.potential_risk_other})]}),i.jsxs(N,{title:"Why Unsafe",children:[i.jsx(z,{label:"Unsafe Reasons",value:t.unsafe_reasons&&t.unsafe_reasons.length>0?i.jsx(U,{gap:4,children:t.unsafe_reasons.map((a,s)=>i.jsx(ve,{color:"red",children:a},s))}):"-"}),t.unsafe_reason_other&&i.jsx(z,{label:"Other Unsafe Reason",value:t.unsafe_reason_other})]}),i.jsxs(N,{title:"Control Measures",children:[i.jsx(z,{label:"Control Measures",value:t.control_measures&&t.control_measures.length>0?i.jsx(U,{gap:4,children:t.control_measures.map((a,s)=>i.jsx(ve,{color:"green",children:a},s))}):"-"}),t.control_measure_other&&i.jsx(z,{label:"Other Control Measure",value:t.control_measure_other}),i.jsx(z,{label:"Corrective Action",value:t.corrective_action})]}),t.status==="resolved"&&t.resolution_notes&&i.jsx(N,{title:"Resolution Information",children:i.jsxs(F,{children:[i.jsxs(F.Col,{span:{base:12,sm:6},children:[i.jsx(z,{label:"Resolved By",value:t.resolved_by_name||t.resolved_by_id||"N/A"}),i.jsx(z,{label:"Resolved At",value:t.resolved_at?new Date(t.resolved_at).toLocaleString():"-"})]}),i.jsx(F.Col,{span:12,children:i.jsx(z,{label:"Resolution Notes",value:t.resolution_notes})})]})})]})}function z({label:e,value:r}){return i.jsxs(C,{gap:2,mb:"sm",children:[i.jsx($,{c:"dimmed",fz:"sm",children:e}),i.jsx($,{fw:500,style:{wordBreak:"break-word"},children:r??"-"}),i.jsx(cn,{my:4})]})}function ui(e){ce.open({title:"Add New Hazard Observation Card",children:i.jsx(oi,{onSubmit:()=>{e(),ce.closeAll()}}),size:"75rem",zIndex:2e3,withCloseButton:!1})}function di(e,r){ce.open({title:"Edit Hazard Observation Card",children:i.jsx(si,{id:e,onSubmit:()=>{r(),ce.closeAll()}}),size:"75rem",zIndex:2e3,withCloseButton:!1})}function pi(e){ce.open({title:"View Hazard Observation Card",children:i.jsx(ci,{id:e}),size:"75rem",zIndex:2e3,withCloseButton:!1})}function fi(e,r){ce.open({title:"Resolve Hazard Observation",children:i.jsx(li,{id:e,onSubmit:()=>{r(),ce.closeAll()}}),size:"50rem",zIndex:2e3,withCloseButton:!1})}const hi={open:"red",in_progress:"yellow",resolved:"green",closed:"gray"},mi={open:"Open",in_progress:"In Progress",resolved:"Resolved",closed:"Closed"};async function vi(){const e=await dn.get("/hazard-observations/export/csv");return pn.parse(e.data).data}function bi(e,r){if(e.length===0)return;const n={observation_date:"Tanggal",observation_time:"Waktu",facility:"Fasilitas",observer:"Observer",unsafe_action_condition:"Kondisi Tidak Aman",hazard_types:"Tipe Bahaya",potential_risks:"Potensi Risiko",potential_risk_other:"Potensi Risiko Lainnya",unsafe_reasons:"Alasan Tidak Aman",unsafe_reason_other:"Alasan Lainnya",control_measures:"Tindakan Pengendalian",control_measure_other:"Tindakan Lainnya",corrective_action:"Tindakan Korektif",status:"Status",resolved_by:"Diselesaikan Oleh",resolved_at:"Tanggal Penyelesaian",resolution_notes:"Catatan Penyelesaian"},t=Object.keys(e[0]),a=t.map(f=>n[f]||f).join(","),s=e.map(f=>t.map(h=>{const m=f[h]??"";return m.includes(",")||m.includes('"')||m.includes(`
`)?`"${m.replace(/"/g,'""')}"`:m}).join(",")),o=[a,...s].join(`
`),c=new Blob([o],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(c),l=document.createElement("a");l.href=u,l.setAttribute("download",r),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(u)}function yi(){var _;const{user:e}=pt(),{page:r,limit:n,setLimit:t,setPage:a}=un(),{filters:s,sort:o}=J.useDataTable({sortConfig:{direction:"desc",column:"observation_date"}}),[c,u]=D.useState(!1),{data:l,isLoading:f,refetch:h}=Pn(),{mutate:m}=On(),y=D.useCallback(v=>{ce.openConfirmModal({title:"Delete Hazard Observation",children:"Are you sure you want to delete this hazard observation?",confirmProps:{color:"red"},labels:{confirm:"Delete",cancel:"Cancel"},onConfirm:()=>{m(v),h()}})},[m,h]),d=D.useCallback(async()=>{u(!0);try{const v=await vi();if(!v||v.length===0){Qe.show({message:"No data to export",color:"yellow"});return}const P=`hazard_observations_${new Date().toISOString().split("T")[0]}.csv`;bi(v,P),Qe.show({title:"Export Berhasil",message:"File berhasil diunduh",color:"green"})}catch(v){console.error("Export failed:",v),Qe.show({message:"Export failed: "+v,color:"red"})}finally{u(!1)}},[]),p=(e==null?void 0:e.department)==="HSE",x=(e==null?void 0:e.role)==="MANAGER",j=D.useMemo(()=>[{accessor:"observation_date",title:"Date",sortable:!0,render:({observation_date:v,observation_time:A})=>`${new Date(v).toLocaleDateString()} ${A||""}`},{accessor:"facility_id",title:"Facility",ellipsis:!0,render:({facility_name:v,facility_id:A})=>v||A},{accessor:"unsafe_action_condition",title:"Unsafe Condition",ellipsis:!0,width:250},{accessor:"hazard_types",title:"Hazard Types",render:({hazard_types:v})=>v&&v.length>0?i.jsxs(U,{gap:4,children:[v.slice(0,2).map((A,P)=>i.jsx(ve,{size:"sm",children:A},P)),v.length>2&&i.jsxs(ve,{size:"sm",variant:"outline",children:["+",v.length-2]})]}):"-"},{accessor:"status",title:"Status",sortable:!0,textAlign:"center",render:({status:v})=>i.jsx(ve,{color:hi[v],children:mi[v]})},{accessor:"actions",title:"Actions",textAlign:"right",width:180,render:v=>i.jsx(J.Actions,{onView:()=>pi(v.id),onResolve:p&&v.status!=="resolved"&&v.status!=="closed"?()=>fi(v.id,h):null,onEdit:x||v.observer_id===(e==null?void 0:e.id)?()=>di(v.id,h):null,onDelete:x?()=>y(v.id):null})}],[y,p,x,e==null?void 0:e.id,h]),g=fn.alert;return i.jsxs(J.Container,{children:[i.jsx(J.Title,{icon:i.jsx(g,{size:25}),title:"Hazard Observation Cards",actions:i.jsxs(U,{gap:"xs",children:[i.jsx(He,{variant:"subtle",size:"xs",leftSection:i.jsx(Rn,{size:16}),onClick:d,loading:c,children:"Export"}),i.jsx(Sn,{variant:"default",size:"xs",onClick:()=>ui(h),children:"Add Observation"})]})}),i.jsx(J.Filters,{filters:s.filters,onClear:s.clear}),i.jsx(J.Content,{children:i.jsx(J.Table,{striped:!0,minHeight:240,noRecordsText:J.noRecordsText("hazard observations"),recordsPerPageLabel:J.recordsPerPageLabel("hazard observations"),paginationText:J.paginationText("hazard observations"),page:r,records:(l==null?void 0:l.data)??[],fetching:f,onPageChange:a,recordsPerPage:n,totalRecords:((_=l==null?void 0:l.meta)==null?void 0:_.total)??0,onRecordsPerPageChange:t,recordsPerPageOptions:[5,15,30],sortStatus:o.status,onSortStatusChange:o.change,columns:j,pinLastColumn:!0,highlightOnHover:!0})})]})}function Mi(){const{user:e}=pt(),n=[{label:"Hazard Observations",href:(e==null?void 0:e.role)==="MANAGER"?Ct.manager.hazardObservations:Ct.employee.hazardObservations}];return i.jsxs(hn,{title:"Hazard Observations",children:[i.jsx(mn,{title:"Hazard Observation Cards",breadcrumbs:n}),i.jsxs(C,{gap:"lg",children:[i.jsx(ti,{}),i.jsx(yi,{})]})]})}export{Mi as default};
